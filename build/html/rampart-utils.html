

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>rampart.utils &mdash; Rampart 0.6.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
  
    <link rel="stylesheet" href="_static/hacks.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Rampart 0.6.1 documentation" href="index.html"/>
        <link rel="next" title="Rampart Thread Functions" href="rampart-thread.html"/>
        <link rel="prev" title="Introduction to Rampart" href="rampart-main.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Rampart
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="rampart-main.html">Rampart JavaScript</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Rampart Utility Functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#license">License</a></li>
<li class="toctree-l2"><a class="reference internal" href="#general-utilities">General Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#printf">printf</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sprintf">sprintf</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bprintf">bprintf</a></li>
<li class="toctree-l3"><a class="reference internal" href="#abprintf">abprintf</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hexify">hexify</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dehexify">dehexify</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stringtonumber">stringToNumber</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stringtobuffer">stringToBuffer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#buffertostring">bufferToString</a></li>
<li class="toctree-l3"><a class="reference internal" href="#objecttoquery">objectToQuery</a></li>
<li class="toctree-l3"><a class="reference internal" href="#querytoobject">queryToObject</a></li>
<li class="toctree-l3"><a class="reference internal" href="#getchar">getchar</a></li>
<li class="toctree-l3"><a class="reference internal" href="#readfile">readFile</a></li>
<li class="toctree-l3"><a class="reference internal" href="#trim">trim</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stat">stat</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lstat">lstat</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exec">exec</a></li>
<li class="toctree-l3"><a class="reference internal" href="#shell">shell</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fork">fork</a></li>
<li class="toctree-l3"><a class="reference internal" href="#newpipe">newPipe</a></li>
<li class="toctree-l3"><a class="reference internal" href="#daemon">daemon</a></li>
<li class="toctree-l3"><a class="reference internal" href="#forkpty">forkpty</a></li>
<li class="toctree-l3"><a class="reference internal" href="#kill">kill</a></li>
<li class="toctree-l3"><a class="reference internal" href="#getcwd">getcwd</a></li>
<li class="toctree-l3"><a class="reference internal" href="#chdir">chdir</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mkdir">mkdir</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rmdir">rmdir</a></li>
<li class="toctree-l3"><a class="reference internal" href="#readdir">readDir</a></li>
<li class="toctree-l3"><a class="reference internal" href="#copyfile">copyFile</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rmfile">rmFile</a></li>
<li class="toctree-l3"><a class="reference internal" href="#link">link</a></li>
<li class="toctree-l3"><a class="reference internal" href="#symlink">symlink</a></li>
<li class="toctree-l3"><a class="reference internal" href="#chmod">chmod</a></li>
<li class="toctree-l3"><a class="reference internal" href="#realpath">realPath</a></li>
<li class="toctree-l3"><a class="reference internal" href="#touch">touch</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rename">rename</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sleep">sleep</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gettype">getType</a></li>
<li class="toctree-l3"><a class="reference internal" href="#timezone">timezone</a></li>
<li class="toctree-l3"><a class="reference internal" href="#datefmt">dateFmt</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scandate">scanDate</a></li>
<li class="toctree-l3"><a class="reference internal" href="#autoscandate">autoScanDate</a></li>
<li class="toctree-l3"><a class="reference internal" href="#use">use</a></li>
<li class="toctree-l3"><a class="reference internal" href="#load">load</a></li>
<li class="toctree-l3"><a class="reference internal" href="#errorconfig">errorConfig</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deepcopy">deepCopy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#eventcallback">eventCallback</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#file-handle-utilities">File Handle Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fopen">fopen</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fopenbuffer">fopenBuffer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fclose">fclose</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fprintf">fprintf</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fseek">fseek</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rewind">rewind</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ftell">ftell</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fflush">fflush</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fread">fread</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fgets">fgets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fwrite">fwrite</a></li>
<li class="toctree-l3"><a class="reference internal" href="#readline">readLine</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#rand-hash-and-hyperloglog">Rand, Hash and HyperLogLog</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#rand">rand</a></li>
<li class="toctree-l3"><a class="reference internal" href="#irand">irand</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gaussrand">gaussrand</a></li>
<li class="toctree-l3"><a class="reference internal" href="#normrand">normrand</a></li>
<li class="toctree-l3"><a class="reference internal" href="#srand">srand</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hash">hash</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hll">hll</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hll-add">hll.add</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hll-addfile">hll.addFile</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hll-count">hll.count</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hll-merge">hll.merge</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hll-getbuffer">hll.getBuffer</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="rampart-thread.html">Rampart Thread Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="sqltoc.html">The rampart-sql module</a></li>
<li class="toctree-l1"><a class="reference internal" href="rampart-server.html">The rampart-server module</a></li>
<li class="toctree-l1"><a class="reference internal" href="rampart-net.html">The rampart-net module</a></li>
<li class="toctree-l1"><a class="reference internal" href="rampart-html.html">The rampart-html module</a></li>
<li class="toctree-l1"><a class="reference internal" href="rampart-crypto.html">The rampart-crypto module</a></li>
<li class="toctree-l1"><a class="reference internal" href="rampart-curl.html">The rampart-curl module</a></li>
<li class="toctree-l1"><a class="reference internal" href="rampart-lmdb.html">The rampart-lmdb module</a></li>
<li class="toctree-l1"><a class="reference internal" href="rampart-redis.html">The rampart-redis module</a></li>
<li class="toctree-l1"><a class="reference internal" href="rampart-python.html">The rampart-python module</a></li>
<li class="toctree-l1"><a class="reference internal" href="rampart-robots.html">The rampart-robots module</a></li>
<li class="toctree-l1"><a class="reference internal" href="rampart-cmark.html">The rampart-cmark module</a></li>
<li class="toctree-l1"><a class="reference internal" href="rampart-almanac.html">The rampart-almanac module</a></li>
<li class="toctree-l1"><a class="reference internal" href="rampart-url.html">The rampart-url module</a></li>
<li class="toctree-l1"><a class="reference internal" href="rampart-extras.html">Extras</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorialtoc.html">Tutorials</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Rampart</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>rampart.utils</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/rampart-utils.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="rampart-utils">
<h1>rampart.utils<a class="headerlink" href="#rampart-utils" title="Permalink to this headline">¬∂</a></h1>
<p>Utility functions are provided in the global <code class="docutils literal notranslate"><span class="pre">rampart.utils</span></code> <span class="green">Object</span>.
These functions bring file io and other functionality to Duktape JavaScript.</p>
<div class="section" id="license">
<h2>License<a class="headerlink" href="#license" title="Permalink to this headline">¬∂</a></h2>
<p>The modified <code class="docutils literal notranslate"><span class="pre">printf</span></code> code used in the rampart utilities and in
<a class="reference internal" href="rampart-server.html#the-rampart-server-http-module"><span class="std std-ref">the Rampart Server Module</span></a>
is provided by
<a class="reference external" href="https://github.com/mpaland/printf">Marco Paland</a> under the
<a class="reference external" href="https://github.com/mpaland/printf/blob/master/LICENSE">MIT License</a>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">%!H</span></code> HTML escape decoding is provided by
<a class="reference external" href="https://bitbucket.org/cggaertner/cstuff/src/master/entities.c">Christoph G√§rtner</a>
under the  <a class="reference external" href="https://www.boost.org/users/license.html">Boost License</a>.</p>
<p>The utilities are included in Rampart JavaScript and as such are licensed under
the same MIT license.</p>
</div>
<div class="section" id="general-utilities">
<h2>General Utilities<a class="headerlink" href="#general-utilities" title="Permalink to this headline">¬∂</a></h2>
<div class="section" id="printf">
<h3>printf<a class="headerlink" href="#printf" title="Permalink to this headline">¬∂</a></h3>
<p>Print a formatted string to stdout.  Provides C-like
<a class="reference external" href="https://man7.org/linux/man-pages/man3/printf.3.html">printf(3)</a>
functionality in JavaScript.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">printf</span><span class="p">(</span><span class="nx">fmt</span><span class="p">,</span> <span class="p">...)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Return Value:</dt>
<dd><span class="green">Number</span>. The length in bytes of the printed string.</dd>
</dl>
<p>Standard formats:  Most of the normal flags and formats are respected.
See standard formats and flags from
<a class="reference external" href="https://man7.org/linux/man-pages/man3/printf.3.html">printf(3)</a>.</p>
<p>Extended (non-standard) formats:</p>
<blockquote>
<div><ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">%s</span></code> - corresponding argument is treated as a <span class="green">String</span>
(converted/coerced if necessary; <span class="green">Objects</span> are converted the
same as for <code class="docutils literal notranslate"><span class="pre">%J</span></code> and <span class="green">Buffers</span>
are printed as is).</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">%S</span></code> - same as <code class="docutils literal notranslate"><span class="pre">%s</span></code> except an error is thrown if the corresponding argument is
not a <span class="green">String</span>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">%J</span></code> - print <span class="green">Object</span> as JSON.  An optional width (i.e.
<code class="docutils literal notranslate"><span class="pre">printf(&quot;%4J&quot;,</span> <span class="pre">obj);</span></code>) may be given which will print with new lines and
indentation of the specified amount. Thus <code class="docutils literal notranslate"><span class="pre">printf(&quot;%4J&quot;,</span> <span class="pre">obj);</span></code> is
equivalent to <code class="docutils literal notranslate"><span class="pre">printf(&quot;%s&quot;,</span> <span class="pre">JSON.stringify(obj,</span> <span class="pre">null,</span> <span class="pre">4)</span> <span class="pre">);</span></code>.</p>
<blockquote>
<div><ul class="simple">
<li>if <code class="docutils literal notranslate"><span class="pre">!</span></code> flag is present, a safe version of JSON will be printed where
any references to inner <span class="green">Objects</span> are marked.  See second
example below.  Note: if <code class="docutils literal notranslate"><span class="pre">!</span></code> is omitted but printing would fail
because of cyclic references, then <code class="docutils literal notranslate"><span class="pre">!</span></code> is implied.  Also this flag
will print any methods of an object which would otherwise be hidden
with values such as <code class="docutils literal notranslate"><span class="pre">myfunc:</span> <span class="pre">{&quot;_ecmascript_func&quot;:</span> <span class="pre">true}</span></code>.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">%B</span></code> - print contents of a <span class="green">Buffer</span> or <span class="green">String</span> as
base64.</p>
<blockquote>
<div><ul class="simple">
<li>If <code class="docutils literal notranslate"><span class="pre">!</span></code> flag present, it decodes a <span class="green">Buffer</span> or
<span class="green">String</span> containing base64 (throws an error if not valid
base64).</li>
<li>If a width is given (e.g. <code class="docutils literal notranslate"><span class="pre">%80B</span></code>), a newline will be printed
after every <code class="docutils literal notranslate"><span class="pre">width</span></code> characters.</li>
<li>If the <code class="docutils literal notranslate"><span class="pre">-</span></code> flag is present and <code class="docutils literal notranslate"><span class="pre">!</span></code> is not present, the output
will be a modified url safe base64 (using <code class="docutils literal notranslate"><span class="pre">-</span></code> and <code class="docutils literal notranslate"><span class="pre">_</span></code> in place
of <code class="docutils literal notranslate"><span class="pre">+</span></code> and <code class="docutils literal notranslate"><span class="pre">/</span></code>).</li>
<li>If the <code class="docutils literal notranslate"><span class="pre">0</span></code> flag is given (e.g. <code class="docutils literal notranslate"><span class="pre">%0B</span></code> or <code class="docutils literal notranslate"><span class="pre">%-080B</span></code>), and <code class="docutils literal notranslate"><span class="pre">!</span></code>
is not present, the output will not be padded with <code class="docutils literal notranslate"><span class="pre">=</span></code> characters.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">%U</span></code> - url encode (or if <code class="docutils literal notranslate"><span class="pre">!</span></code> flag present, decode) a <span class="green">String</span>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">%H</span></code> - html encode (or if <code class="docutils literal notranslate"><span class="pre">!</span></code> flag present, decode) a <span class="green">String</span>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">%P</span></code> - pretty print a <span class="green">String</span> or <span class="green">Buffer</span>.  Expects
text with white space.  Format is <code class="docutils literal notranslate"><span class="pre">%[!][-][i][.w]P</span></code> where:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">i</span></code> is the optional level of indentation.  Each output line will be indented
by this amount.  Default is <code class="docutils literal notranslate"><span class="pre">0</span></code>.  If <code class="docutils literal notranslate"><span class="pre">0</span></code>, the indent level for
each paragraph will match the indentation of the first line of the corresponding
paragraph in the input text (number of spaces at beginning of the paragraph).</li>
<li><code class="docutils literal notranslate"><span class="pre">-</span></code> when used with the <code class="docutils literal notranslate"><span class="pre">!</span></code> flag optionally sets indentation to 0
on all lines regardless of <code class="docutils literal notranslate"><span class="pre">i</span></code> or leading white space on first line.</li>
<li><code class="docutils literal notranslate"><span class="pre">.w</span></code> where <code class="docutils literal notranslate"><span class="pre">w</span></code> is the optional length of each line (default <code class="docutils literal notranslate"><span class="pre">80</span></code> if not
specified).</li>
<li><code class="docutils literal notranslate"><span class="pre">!</span></code> specifies, if present, that newlines are not converted to spaces (but text
after newlines is still indented).  In all cases, a double newline
(‚Äú\n\n‚Äù) is considered a separator of paragraphs and is respected.</li>
</ul>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">%w</span></code> - a shortcut format for <code class="docutils literal notranslate"><span class="pre">%!-.wP</span></code> - where <code class="docutils literal notranslate"><span class="pre">w</span></code> is effectively unlimited.
Remove all leading white space from each line and don‚Äôt wrap lines.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">%C</span></code> - like <code class="docutils literal notranslate"><span class="pre">%c</span></code> but prints multi-byte character.  Example:</p>
<p><code class="docutils literal notranslate"><span class="pre">rampart.utils.printf(&quot;%C&quot;,</span> <span class="pre">0xf09f9983);</span></code> prints <code class="docutils literal notranslate"><span class="pre">üôÉ</span></code>.</p>
<p>Requires a number, 1-4 bytes (<code class="docutils literal notranslate"><span class="pre">0</span></code>-<code class="docutils literal notranslate"><span class="pre">4294967295</span></code>, or <code class="docutils literal notranslate"><span class="pre">0x0</span></code>-<code class="docutils literal notranslate"><span class="pre">0xffffffff</span></code>).</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">%M</span></code> - print multiline string.  Corresponding argument must be an <span class="green">Array</span>.  This
prints each member of the array without scrolling the terminal when called multiple
times.</p>
<p>Example:</p>
</li>
</ul>
<blockquote>
<div><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="mi">20</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">,</span><span class="nx">j</span><span class="o">+=</span><span class="mi">10</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">printf</span><span class="p">(</span><span class="s2">&quot;%M&quot;</span><span class="p">,</span> <span class="p">[</span><span class="sb">`line 1: </span><span class="si">${</span><span class="nx">i</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span> <span class="sb">`line 2: </span><span class="si">${</span><span class="nx">j</span><span class="si">}</span><span class="sb">`</span><span class="p">]);</span>
    <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
<span class="p">}</span>
<span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">printf</span><span class="p">(</span><span class="s2">&quot;done\n&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
</div></blockquote>
<p>Extended (non-standard) flags:</p>
<blockquote>
<div><ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">a</span></code> - For all formats, accent output with color, if on a terminal
that supports colors and using <code class="docutils literal notranslate"><span class="pre">printf(...)</span></code> or <code class="docutils literal notranslate"><span class="pre">fprintf(stderr,...)</span></code>.
Colors must be provided in a <span class="green">String</span> before the
parameter that will be colorized.  Format for the color parameter is
<code class="docutils literal notranslate"><span class="pre">foregroundColor[,</span> <span class="pre">backgroundColor[,</span> <span class="pre">[option]]]</span></code> where:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">ForegroundColor</span></code> is the color of the text.</li>
<li><code class="docutils literal notranslate"><span class="pre">backgroundColor</span></code> is the background color.</li>
<li><code class="docutils literal notranslate"><span class="pre">option</span></code> is <code class="docutils literal notranslate"><span class="pre">blink</span></code> or <code class="docutils literal notranslate"><span class="pre">flashing</span></code> for blinking text.</li>
</ul>
</div></blockquote>
<p>Color is specified in a css compatible <code class="docutils literal notranslate"><span class="pre">rgb(x,</span> <span class="pre">x,</span> <span class="pre">x)</span></code>
format, by providing a <a class="reference external" href="https://en.wikipedia.org/wiki/Web_colors">named css color</a>
or <a class="reference external" href="https://plumbum.readthedocs.io/en/latest/colorlib.html#color-support">named terminal color</a>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">^</span></code> - same as <code class="docutils literal notranslate"><span class="pre">a</span></code> except 16 color mode is forced.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">A</span></code> - same as <code class="docutils literal notranslate"><span class="pre">a</span></code> except 256 color mode is forced.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">&#64;</span></code> - same as <code class="docutils literal notranslate"><span class="pre">a</span></code> except truecolor mode is forced.</p>
</li>
</ul>
</div></blockquote>
<p>Color with <code class="docutils literal notranslate"><span class="pre">%H</span></code> format:</p>
<blockquote>
<div><ul class="simple">
<li>Using <code class="docutils literal notranslate"><span class="pre">%aH</span></code> or any of the forced versions (<code class="docutils literal notranslate"><span class="pre">^</span></code>, <code class="docutils literal notranslate"><span class="pre">A</span></code> or <code class="docutils literal notranslate"><span class="pre">&#64;</span></code>) will perform the same operation as
with other format codes.  In addition, it will wrap the text in a span with the foreground and background
colors set as specified.  It will also add the <code class="docutils literal notranslate"><span class="pre">option</span></code> as a class name to the span.</li>
</ul>
<p>Example:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">printf</span><span class="p">(</span><span class="s2">&quot;%aH&quot;</span><span class="p">,</span> <span class="s2">&quot;green, white, myclassname&quot;</span><span class="p">,</span> <span class="s2">&quot;Text in a span&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>Output would be as follows:</p>
<blockquote>
<div><span class="green">&lt;span class=‚Äùrp-color myclassname‚Äù style=‚Äùcolor:Green; background-color:White;‚Äù&gt;Text in a span&lt;/span&gt;</span></div></blockquote>
<p>If using <code class="docutils literal notranslate"><span class="pre">sprintf</span></code> or if not printing to the terminal, output would be as follows:</p>
<blockquote>
<div>&lt;span class=‚Äùrp-color myclassname‚Äù style=‚Äùcolor:Green; background-color:White;‚Äù&gt;Text in a span&lt;/span&gt;</div></blockquote>
</div></blockquote>
<p>Colors with <code class="docutils literal notranslate"><span class="pre">%J</span></code> format:</p>
<blockquote>
<div><ul class="simple">
<li>Using <code class="docutils literal notranslate"><span class="pre">%aJ</span></code> or any of the forced versions (<code class="docutils literal notranslate"><span class="pre">^</span></code>, <code class="docutils literal notranslate"><span class="pre">A</span></code> or <code class="docutils literal notranslate"><span class="pre">&#64;</span></code>), takes as the color argument a number (pallate number)
rather than a foreground and background color.  There are currently four pallates, numbered <code class="docutils literal notranslate"><span class="pre">0-3</span></code>.  Anything not a number
or outside of that range will default to <code class="docutils literal notranslate"><span class="pre">0</span></code>.</li>
</ul>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">myObj</span> <span class="o">=</span> <span class="p">{</span><span class="nb">Number</span><span class="o">:</span><span class="mf">1.23</span><span class="p">,</span> <span class="nx">Bool</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span> <span class="nb">String</span><span class="o">:</span><span class="s2">&quot;Hello World!&quot;</span><span class="p">,</span> <span class="nx">Null</span><span class="o">:</span> <span class="kc">null</span><span class="p">};</span>
<span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">printf</span><span class="p">(</span><span class="s2">&quot;%a3J\n&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">myObj</span><span class="p">);</span>
<span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">printf</span><span class="p">(</span><span class="s2">&quot;%a3J\n&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">myObj</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight json-custom"><pre style=padding:0.6em;">
{
   <span class="nt0">Number"</span>: <span class="n0">1.23</span>,
   <span class="nt0">"Bool"</span>: <span class="b0">true</span>,
   <span class="nt0">"String"</span>: <span class="s0">"Hello World!"</span>,
   <span class="nt0">"Null"</span>: <span class="N0">null</span>
}
{
   <span class="nt1">Number"</span>: <span class="n1">1.23</span>,
   <span class="nt1">"Bool"</span>: <span class="b1">true</span>,
   <span class="nt1">"String"</span>: <span class="s1">"Hello World!"</span>,
   <span class="nt1">"Null"</span>: <span class="N1">null</span>
}
</pre></div></div></blockquote>
<p>Basic printf example:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">uenc</span> <span class="o">=</span> <span class="s2">&quot;a+url+encoded+string.+%27%23%24%3f%27&quot;</span><span class="p">;</span>

<span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">printf</span><span class="p">(</span><span class="s2">&quot;Encoded: %s\nDecoded: %!U\n&quot;</span><span class="p">,</span> <span class="nx">uenc</span><span class="p">,</span> <span class="nx">uenc</span><span class="p">);</span>

<span class="cm">/* expected output:</span>
<span class="cm">Encoded: a+url+encoded+string.+%27%23%24%3f%27</span>
<span class="cm">Decoded: a url encoded string. &#39;#$?&#39;</span>
<span class="cm">*/</span>

<span class="kd">var</span> <span class="nx">getty</span> <span class="o">=</span> <span class="s2">&quot;Four score and seven years ago our fathers\n&quot;</span> <span class="o">+</span>
         <span class="s2">&quot;brought forth on this continent, a new nation,\n&quot;</span> <span class="o">+</span>
         <span class="s2">&quot;conceived in Liberty, and dedicated to the proposition\n&quot;</span> <span class="o">+</span>
         <span class="s2">&quot;that all men are created equal.&quot;</span>

<span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">printf</span><span class="p">(</span><span class="s2">&quot;%5.40P\n&quot;</span><span class="p">,</span> <span class="nx">getty</span><span class="p">);</span>
<span class="cm">/* or</span>
<span class="cm">     rampart.utils.printf(&quot;%*.*P\n&quot;, 5, 40, getty);</span>
<span class="cm">*/</span>

<span class="cm">/* expected output:</span>
<span class="cm">     Four score and seven years ago our</span>
<span class="cm">     fathers brought forth on this</span>
<span class="cm">     continent, a new nation, conceived</span>
<span class="cm">     in Liberty, and dedicated to the</span>
<span class="cm">     proposition that all men are</span>
<span class="cm">     created equal.</span>
<span class="cm">*/</span>

 <span class="kd">var</span> <span class="nx">html</span> <span class="o">=</span>
 <span class="s2">&quot;&lt;html&gt;\n&quot;</span><span class="o">+</span>
 <span class="s2">&quot;  &lt;body&gt;\n&quot;</span><span class="o">+</span>
 <span class="s2">&quot;    &lt;div&gt;\n&quot;</span><span class="o">+</span>
 <span class="s2">&quot;      content\n&quot;</span><span class="o">+</span>
 <span class="s2">&quot;    &lt;/div&gt;\n&quot;</span><span class="o">+</span>
 <span class="s2">&quot;  &lt;/body&gt;\n&quot;</span><span class="o">+</span>
 <span class="s2">&quot;&lt;/html&gt;\n&quot;</span><span class="p">;</span>

 <span class="cm">/* remove leading white space */</span>
 <span class="cm">/* rampart.utils.printf(&quot;%!-.1000P&quot;, html); */</span>
 <span class="cm">/* or more simply as */</span>
 <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">printf</span><span class="p">(</span><span class="s2">&quot;%w&quot;</span><span class="p">,</span> <span class="nx">html</span><span class="p">);</span>

 <span class="cm">/* expected output</span>
<span class="cm"> &lt;html&gt;</span>
<span class="cm"> &lt;body&gt;</span>
<span class="cm"> &lt;div&gt;</span>
<span class="cm"> content</span>
<span class="cm"> &lt;/div&gt;</span>
<span class="cm"> &lt;/body&gt;</span>
<span class="cm"> &lt;/html&gt;</span>
<span class="cm"> */</span>
</pre></div>
</div>
<p>Example printing JSON with cyclic references:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="p">{</span><span class="nx">a</span><span class="o">:</span><span class="p">{</span><span class="nx">c</span><span class="o">:</span><span class="mi">1</span><span class="p">},</span><span class="nx">b</span><span class="o">:</span><span class="p">{}</span> <span class="p">};</span>
<span class="nx">x</span><span class="p">.</span><span class="nx">b</span><span class="p">.</span><span class="nx">a</span> <span class="o">=</span> <span class="nx">x</span><span class="p">.</span><span class="nx">a</span><span class="p">;</span>

<span class="c1">// without &quot;!&quot;, it is printed as normal</span>
<span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">printf</span><span class="p">(</span><span class="s2">&quot;%3J\n&quot;</span><span class="p">,</span> <span class="nx">x</span><span class="p">);</span>

<span class="cm">/* expected results</span>
<span class="cm">   {</span>
<span class="cm">      &quot;a&quot;: {</span>
<span class="cm">         &quot;c&quot;: 1</span>
<span class="cm">      },</span>
<span class="cm">      &quot;b&quot;: {</span>
<span class="cm">         &quot;a&quot;: {</span>
<span class="cm">            &quot;c&quot;: 1</span>
<span class="cm">         }</span>
<span class="cm">      }</span>
<span class="cm">   }</span>
<span class="cm">*/</span>

<span class="c1">// with &quot;!&quot; all self references are printed</span>
<span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">printf</span><span class="p">(</span><span class="s2">&quot;%!3J\n&quot;</span><span class="p">,</span> <span class="nx">x</span><span class="p">);</span>

<span class="cm">/* expected results:</span>
<span class="cm">   {</span>
<span class="cm">      &quot;a&quot;: {</span>
<span class="cm">         &quot;c&quot;: 1</span>
<span class="cm">      },</span>
<span class="cm">      &quot;b&quot;: {</span>
<span class="cm">         &quot;a&quot;: {</span>
<span class="cm">            &quot;_cyclic_ref&quot;: &quot;$.a&quot;</span>
<span class="cm">         }</span>
<span class="cm">      }</span>
<span class="cm">   }</span>
<span class="cm">*/</span>

<span class="c1">// add cyclic ref</span>
<span class="nx">x</span><span class="p">.</span><span class="nx">x_ref</span> <span class="o">=</span> <span class="nx">x</span><span class="p">;</span>

<span class="c1">// with a cyclic ref present, &quot;!&quot; is implied</span>
<span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">printf</span><span class="p">(</span><span class="s2">&quot;%3J\n&quot;</span><span class="p">,</span> <span class="nx">x</span><span class="p">);</span>

<span class="cm">/* expected results:</span>
<span class="cm">   {</span>
<span class="cm">      &quot;a&quot;: {</span>
<span class="cm">         &quot;c&quot;: 1</span>
<span class="cm">      },</span>
<span class="cm">      &quot;b&quot;: {</span>
<span class="cm">         &quot;a&quot;: {</span>
<span class="cm">            &quot;_cyclic_ref&quot;: &quot;$.a&quot;</span>
<span class="cm">         }</span>
<span class="cm">      },</span>
<span class="cm">      &quot;x_ref&quot;: {</span>
<span class="cm">         &quot;_cyclic_ref&quot;: &quot;$&quot;</span>
<span class="cm">      }</span>
<span class="cm">   }</span>
<span class="cm">*/</span>
</pre></div>
</div>
</div>
<div class="section" id="sprintf">
<h3>sprintf<a class="headerlink" href="#sprintf" title="Permalink to this headline">¬∂</a></h3>
<p>Same as <code class="docutils literal notranslate"><span class="pre">printf()</span></code> except a <span class="green">String</span> is returned</p>
<dl class="docutils">
<dt>Return Value:</dt>
<dd><span class="green">String</span>. The formatted string.</dd>
</dl>
</div>
<div class="section" id="bprintf">
<h3>bprintf<a class="headerlink" href="#bprintf" title="Permalink to this headline">¬∂</a></h3>
<p>Same as <code class="docutils literal notranslate"><span class="pre">sprintf()</span></code> except a <span class="green">Buffer</span> is returned.</p>
<dl class="docutils">
<dt>Return Value:</dt>
<dd><span class="green">Buffer</span>.  The formatted string as a <span class="green">Buffer</span>.</dd>
</dl>
</div>
<div class="section" id="abprintf">
<h3>abprintf<a class="headerlink" href="#abprintf" title="Permalink to this headline">¬∂</a></h3>
<p>Same as <code class="docutils literal notranslate"><span class="pre">bprintf()</span></code> except a provided <span class="green">Buffer</span> is resized and appended.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">newBuf</span> <span class="o">=</span> <span class="nx">abprintf</span><span class="p">(</span><span class="nx">oldbuf</span><span class="p">[,</span> <span class="nx">start</span><span class="p">],</span> <span class="nx">fmt</span><span class="p">,</span> <span class="p">...);</span>
</pre></div>
</div>
<p>Where:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">oldbuf</span></code> is a <span class="green">Buffer</span> - the <span class="green">Buffer</span> to be appended.</li>
<li><code class="docutils literal notranslate"><span class="pre">start</span></code> is an optional <span class="green">Number</span>, where in <code class="docutils literal notranslate"><span class="pre">oldbuf</span></code> to start
writing data.  Default is the end of <code class="docutils literal notranslate"><span class="pre">oldbuf</span></code>.  May be a negative
number, signifying how many bytes from the end of the string to start.</li>
<li><code class="docutils literal notranslate"><span class="pre">fmt,</span> <span class="pre">...</span></code> - A format <span class="green">String</span> and optional format
parameters.</li>
</ul>
</div></blockquote>
<dl class="docutils">
<dt>Return Value:</dt>
<dd><span class="green">Buffer</span>.  The formatted string appended to <code class="docutils literal notranslate"><span class="pre">oldbuf</span></code> as a dynamic <span class="green">Buffer</span>.</dd>
<dt>Note:</dt>
<dd>The <span class="green">Buffer</span> <code class="docutils literal notranslate"><span class="pre">oldbuf</span></code> will be altered if it is a dynamic
buffer.  Otherwise, it will be copied and <code class="docutils literal notranslate"><span class="pre">oldbuf</span></code> remains unaltered.</dd>
</dl>
</div>
<div class="section" id="hexify">
<h3>hexify<a class="headerlink" href="#hexify" title="Permalink to this headline">¬∂</a></h3>
<p>Convert data to a hex string.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">hexstring</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">hexify</span><span class="p">(</span><span class="nx">data</span> <span class="p">[,</span> <span class="nx">upper</span><span class="p">]);</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">data</span></code> is the string of bytes (<span class="green">String</span> or <span class="green">Buffer</span>)
to be converted and <code class="docutils literal notranslate"><span class="pre">upper</span></code> is an optional <span class="green">Boolean</span>, which if
<code class="docutils literal notranslate"><span class="pre">true</span></code> prints using upper-case <code class="docutils literal notranslate"><span class="pre">A-F</span></code>.</p>
<dl class="docutils">
<dt>Return Value:</dt>
<dd><span class="green">String</span>. Each byte in data is converted to its two character hex representation.</dd>
</dl>
<p>Example:  See <a class="reference internal" href="#dehexify">dehexify</a> below.</p>
</div>
<div class="section" id="dehexify">
<h3>dehexify<a class="headerlink" href="#dehexify" title="Permalink to this headline">¬∂</a></h3>
<p>Convert a hex string to a string of bytes.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">dehexify</span><span class="p">(</span><span class="nx">hexstring</span><span class="p">);</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Return Value:</dt>
<dd><span class="green">Buffer</span>.  Each two character hex representation converted to a
byte in the binary string.</dd>
</dl>
<p>Example:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">rampart</span><span class="p">.</span><span class="nx">globalize</span><span class="p">(</span><span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">s</span><span class="o">=</span><span class="nx">sprintf</span><span class="p">(</span><span class="s2">&quot;%c%c%c%c&quot;</span><span class="p">,</span><span class="mh">0xF0</span><span class="p">,</span> <span class="mh">0x9F</span><span class="p">,</span> <span class="mh">0x98</span><span class="p">,</span> <span class="mh">0x8A</span><span class="p">);</span>

<span class="nx">printf</span><span class="p">(</span><span class="s2">&quot;0x%s\n&quot;</span><span class="p">,</span> <span class="nx">hexify</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">);</span>
<span class="nx">printf</span><span class="p">(</span><span class="s2">&quot;%s\n&quot;</span><span class="p">,</span> <span class="nx">dehexify</span><span class="p">(</span><span class="nx">hexify</span><span class="p">(</span><span class="nx">s</span><span class="p">))</span> <span class="p">);</span>

<span class="cm">/* expected output:</span>
<span class="cm">0xf09f988a</span>
<span class="cm">üòä</span>
<span class="cm">*/</span>
</pre></div>
</div>
</div>
<div class="section" id="stringtonumber">
<h3>stringToNumber<a class="headerlink" href="#stringtonumber" title="Permalink to this headline">¬∂</a></h3>
<p>Convert various plain English <span class="green">Strings</span> to a <span class="green">Number</span> or
<span class="green">Number</span> range.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">buf</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">stringToNumber</span><span class="p">(</span><span class="nx">nstr</span> <span class="p">[,</span> <span class="nx">retObj</span> <span class="p">]);</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">nstr</span></code> is a <span class="green">String</span> and optional <code class="docutils literal notranslate"><span class="pre">retObj</span></code> is a <span class="green">Boolean</span>.</p>
<p>Examples:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">rampart</span><span class="p">.</span><span class="nx">globalize</span><span class="p">(</span><span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="nx">strintToNumber</span><span class="p">(</span><span class="s2">&quot;five&quot;</span><span class="p">);</span>
<span class="c1">// res = 5</span>

<span class="nx">res</span> <span class="o">=</span> <span class="nx">stringToNumber</span><span class="p">(</span><span class="s2">&quot;three and a half&quot;</span><span class="p">);</span>
<span class="c1">// res = 3.5</span>

<span class="nx">res</span> <span class="o">=</span> <span class="nx">stringToNumber</span><span class="p">(</span><span class="s2">&quot;four score and seven&quot;</span><span class="p">);</span>
<span class="c1">// res = 87</span>

<span class="nx">res</span> <span class="o">=</span> <span class="nx">stringToNumber</span><span class="p">(</span><span class="s2">&quot;five dozen&quot;</span><span class="p">);</span>
<span class="c1">// res = 60</span>

<span class="nx">res</span> <span class="o">=</span> <span class="nx">stringToNumber</span><span class="p">(</span><span class="s2">&quot;a gazillion&quot;</span><span class="p">);</span>
<span class="c1">// res = NaN</span>

<span class="nx">res</span> <span class="o">=</span> <span class="nx">stringToNumber</span><span class="p">(</span><span class="s2">&quot;five dozen&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="cm">/* res = {</span>
<span class="cm">      &quot;value&quot;: 60,</span>
<span class="cm">      &quot;op&quot;: &quot;=&quot;,</span>
<span class="cm">      &quot;rem&quot;: &quot;&quot;</span>
<span class="cm">   }  */</span>

<span class="nx">res</span> <span class="o">=</span> <span class="nx">stringToNumber</span><span class="p">(</span><span class="s2">&quot;five dozen cookies&quot;</span><span class="p">,</span><span class="kc">true</span><span class="p">);</span>
<span class="cm">/* res = {</span>
<span class="cm">      &quot;value&quot;: 60,</span>
<span class="cm">      &quot;op&quot;: &quot;=&quot;,</span>
<span class="cm">      &quot;rem&quot;: &quot;cookies&quot;</span>
<span class="cm">   }  */</span>

<span class="nx">res</span> <span class="o">=</span> <span class="nx">stringToNumber</span><span class="p">(</span><span class="s2">&quot;less than twenty&quot;</span><span class="p">,</span><span class="kc">true</span><span class="p">);</span>
<span class="cm">/* res = {</span>
<span class="cm">      &quot;value&quot;: 20,</span>
<span class="cm">      &quot;op&quot;: &quot;&lt;&quot;,</span>
<span class="cm">      &quot;rem&quot;: &quot;&quot;</span>
<span class="cm">   }  */</span>

<span class="nx">res</span> <span class="o">=</span> <span class="nx">stringToNumber</span><span class="p">(</span><span class="s2">&quot;less than twenty greater than one half is our range&quot;</span><span class="p">,</span><span class="kc">true</span><span class="p">);</span>
<span class="cm">/* res = {</span>
<span class="cm">      &quot;value&quot;: 20,</span>
<span class="cm">      &quot;min&quot;: 0.5,</span>
<span class="cm">      &quot;max&quot;: 20,</span>
<span class="cm">      &quot;rem&quot;: &quot;is our range&quot;</span>
<span class="cm">   }  */</span>
</pre></div>
</div>
</div>
<div class="section" id="stringtobuffer">
<h3>stringToBuffer<a class="headerlink" href="#stringtobuffer" title="Permalink to this headline">¬∂</a></h3>
<p>Performs a byte-for-byte copy of a <span class="green">String</span> into a <span class="green">Buffer</span>.
Also convert one <span class="green">Buffer</span> to a <span class="green">Buffer</span> of another type.
See <code class="docutils literal notranslate"><span class="pre">duk_to_buffer()</span></code> in the
<a class="reference external" href="https://wiki.duktape.org/howtobuffers2x#string-to-buffer-conversion">Duktape documentation</a></p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">buf</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">stringToBuffer</span><span class="p">(</span><span class="nx">data</span> <span class="p">[,</span> <span class="nx">buftype</span> <span class="p">]);</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">data</span></code> is a <span class="green">String</span> or <span class="green">Buffer</span> and <code class="docutils literal notranslate"><span class="pre">buftype</span></code> is one of the following
<span class="green">Strings</span>:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">&quot;fixed&quot;</span></code> - returned <span class="green">Buffer</span> is a ‚Äúfixed‚Äù <span class="green">Buffer</span>.</li>
<li><code class="docutils literal notranslate"><span class="pre">&quot;dynamic&quot;</span></code> - returned <span class="green">Buffer</span> is a ‚Äúdynamic‚Äù <span class="green">Buffer</span>.</li>
</ul>
</div></blockquote>
<p>If no <code class="docutils literal notranslate"><span class="pre">buftype</span></code> is given and <code class="docutils literal notranslate"><span class="pre">data</span></code> is a <span class="green">Buffer</span>, the same type of <span class="green">Buffer</span>
is returned.  If no <code class="docutils literal notranslate"><span class="pre">buftype</span></code> is given and <code class="docutils literal notranslate"><span class="pre">data</span></code> is a <span class="green">String</span>, a ‚Äúfixed‚Äù
<span class="green">Buffer</span> is returned.</p>
<p>See <a class="reference external" href="https://wiki.duktape.org/howtobuffers2x">Duktape documentation</a> for
more information on different types of <span class="green">Buffers</span>.</p>
<dl class="docutils">
<dt>Return Value:</dt>
<dd><span class="green">Buffer</span>.  Contents of <span class="green">String</span>/<span class="green">Buffer</span> copied to a new <span class="green">Buffer</span> <span class="green">Object</span>.</dd>
</dl>
</div>
<div class="section" id="buffertostring">
<h3>bufferToString<a class="headerlink" href="#buffertostring" title="Permalink to this headline">¬∂</a></h3>
<p>Performs a 1:1 copy of the contents of a <span class="green">Buffer</span> to a <span class="green">String</span>.</p>
<p>See <code class="docutils literal notranslate"><span class="pre">duk_buffer_to_string()</span></code> in the
<a class="reference external" href="https://wiki.duktape.org/howtobuffers2x#buffer-to-string-conversion">Duktape documentation</a></p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">str</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">bufferToString</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
</pre></div>
</div>
<p>Where data is a <span class="green">Buffer</span> <span class="green">Object</span>.</p>
<dl class="docutils">
<dt>Return Value:</dt>
<dd><span class="green">String</span>.  Contents of <span class="green">Buffer</span> copied to a new <span class="green">String</span>.</dd>
</dl>
</div>
<div class="section" id="objecttoquery">
<h3>objectToQuery<a class="headerlink" href="#objecttoquery" title="Permalink to this headline">¬∂</a></h3>
<p>Convert an <span class="green">Object</span> of key/value pairs to a <span class="green">String</span> suitable for use as a query
string in an HTTP request.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">qs</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">objectToQuery</span><span class="p">(</span><span class="nx">kvObj</span> <span class="p">[,</span> <span class="nx">arrayOpt</span><span class="p">]);</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">kvObj</span></code> is an <span class="green">Object</span> containing the key/value pairs and <code class="docutils literal notranslate"><span class="pre">arrayOpt</span></code>
controls how <span class="green">Array</span> values are treated. A <span class="green">String</span>,
one of the following:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">&quot;repeat&quot;</span></code> - default value if not specified.  Repeat the key in the
query string with each value from the array.  Example:
<code class="docutils literal notranslate"><span class="pre">{key1:</span> <span class="pre">[&quot;val1&quot;,</span> <span class="pre">&quot;val2&quot;]}</span></code> becomes <code class="docutils literal notranslate"><span class="pre">key1=val1&amp;key1=val2</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">&quot;bracket&quot;</span></code> - similar to repeat, except url encoded <code class="docutils literal notranslate"><span class="pre">[]</span></code> is appended
to the keys.  Example: <code class="docutils literal notranslate"><span class="pre">{key1:</span> <span class="pre">[&quot;val1&quot;,</span> <span class="pre">&quot;val2&quot;]}</span></code> becomes
<code class="docutils literal notranslate"><span class="pre">key1%5B%5D=val1&amp;key1%5B%5D=val2</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">&quot;comma&quot;</span></code> - One key with corresponding values separated by a <code class="docutils literal notranslate"><span class="pre">,</span></code>
(comma).  Example: <code class="docutils literal notranslate"><span class="pre">{key1:</span> <span class="pre">[&quot;val1&quot;,</span> <span class="pre">&quot;val2&quot;]}</span></code> becomes
<code class="docutils literal notranslate"><span class="pre">key1=val1,val2</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">&quot;json&quot;</span></code> - encode array as JSON.  Example:
<code class="docutils literal notranslate"><span class="pre">{key1:</span> <span class="pre">[&quot;val1&quot;,</span> <span class="pre">&quot;val2&quot;]}</span></code> becomes
<code class="docutils literal notranslate"><span class="pre">key1=%5b%22val1%22%2c%22val2%22%5d</span></code>.</li>
</ul>
</div></blockquote>
<p>Note that the values <code class="docutils literal notranslate"><span class="pre">null</span></code> and <code class="docutils literal notranslate"><span class="pre">undefined</span></code> will be translated as the
<span class="green">Strings</span> <code class="docutils literal notranslate"><span class="pre">&quot;null&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;undefined&quot;</span></code> respectively.  Also values which
themselves are <span class="green">Objects</span> will be converted to JSON.</p>
</div>
<div class="section" id="querytoobject">
<h3>queryToObject<a class="headerlink" href="#querytoobject" title="Permalink to this headline">¬∂</a></h3>
<p>Convert a query string to an <span class="green">Object</span>.  Reverses the process, with caveats, of
<a class="reference internal" href="#objecttoquery">objectToQuery</a>().</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">kvObj</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">queryToObject</span><span class="p">(</span><span class="nx">qs</span><span class="p">);</span>
</pre></div>
</div>
<p>Caveats:</p>
<ul class="simple">
<li>All primitive values will be converted to <span class="green">Strings</span> unless
<code class="docutils literal notranslate"><span class="pre">json</span></code> was used.</li>
<li>If <code class="docutils literal notranslate"><span class="pre">repeat</span></code> or <code class="docutils literal notranslate"><span class="pre">bracket</span></code> was used to create the
query string, all values will be returned as strings (even if an <span class="green">Array</span> of
<span class="green">Numbers</span> was given to <a class="reference internal" href="#objecttoquery">objectToQuery</a>().</li>
<li>If <code class="docutils literal notranslate"><span class="pre">comma</span></code> was used to create the query string, no separation of comma
separated values will occur and the entire value will be returned as a <span class="green">String</span>.</li>
<li>If <code class="docutils literal notranslate"><span class="pre">json</span></code> was used, numeric values will be preserved as <span class="green">Numbers</span>.</li>
<li>If the query string contains object like notation (e.g.
<code class="docutils literal notranslate"><span class="pre">&quot;myvar[mykey]=myval&amp;myvar[mykey2]=myval2&quot;</span></code>), it will be converted into
an <span class="green">Object</span> (<code class="docutils literal notranslate"><span class="pre">{myvar:</span> <span class="pre">{mykey:&quot;myval&quot;,</span> <span class="pre">mykey2:&quot;myval2&quot;}</span> <span class="pre">}</span></code>).</li>
</ul>
<p>Example:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">obj</span><span class="o">=</span> <span class="p">{</span>
  <span class="nx">key1</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
  <span class="nx">key2</span><span class="o">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
  <span class="nx">key3</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;val1&quot;</span><span class="p">,</span><span class="s2">&quot;val2&quot;</span><span class="p">]</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">type</span> <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;repeat&quot;</span><span class="p">,</span> <span class="s2">&quot;bracket&quot;</span><span class="p">,</span> <span class="s2">&quot;comma&quot;</span><span class="p">,</span> <span class="s2">&quot;json&quot;</span> <span class="p">];</span>

<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">qs</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">objectToQuery</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">type</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="p">);</span>
    <span class="kd">var</span> <span class="nx">qsobj</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">queryToObject</span><span class="p">(</span><span class="nx">qs</span><span class="p">);</span>
    <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">printf</span><span class="p">(</span><span class="s2">&quot;queryToObject(\n     &#39;%s&#39;\n    ) = \n%3J\n&quot;</span><span class="p">,</span> <span class="nx">qs</span><span class="p">,</span> <span class="nx">qsobj</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/* expected output:</span>
<span class="cm">queryToObject(</span>
<span class="cm">     &#39;key1=null&amp;key2=1&amp;key2=2&amp;key2=3&amp;key3=val1&amp;key3=val2&#39;</span>
<span class="cm">    ) =</span>
<span class="cm">{</span>
<span class="cm">   &quot;key1&quot;: &quot;null&quot;,</span>
<span class="cm">   &quot;key2&quot;: [</span>
<span class="cm">      &quot;1&quot;,</span>
<span class="cm">      &quot;2&quot;,</span>
<span class="cm">      &quot;3&quot;</span>
<span class="cm">   ],</span>
<span class="cm">   &quot;key3&quot;: [</span>
<span class="cm">      &quot;val1&quot;,</span>
<span class="cm">      &quot;val2&quot;</span>
<span class="cm">   ]</span>
<span class="cm">}</span>
<span class="cm">queryToObject(</span>

<span class="cm">&#39;key1=null&amp;key2%5B%5D=1&amp;key2%5B%5D=2&amp;key2%5B%5D=3&amp;key3%5B%5D=val1&amp;key3%5B%5D=val2&#39;</span>
<span class="cm">    ) =</span>
<span class="cm">{</span>
<span class="cm">   &quot;key1&quot;: &quot;null&quot;,</span>
<span class="cm">   &quot;key2&quot;: [</span>
<span class="cm">      &quot;1&quot;,</span>
<span class="cm">      &quot;2&quot;,</span>
<span class="cm">      &quot;3&quot;</span>
<span class="cm">   ],</span>
<span class="cm">   &quot;key3&quot;: [</span>
<span class="cm">      &quot;val1&quot;,</span>
<span class="cm">      &quot;val2&quot;</span>
<span class="cm">   ]</span>
<span class="cm">}</span>
<span class="cm">queryToObject(</span>
<span class="cm">     &#39;key1=null&amp;key2=1,2,3&amp;key3=val1,val2&#39;</span>
<span class="cm">    ) =</span>
<span class="cm">{</span>
<span class="cm">   &quot;key1&quot;: &quot;null&quot;,</span>
<span class="cm">   &quot;key2&quot;: &quot;1,2,3&quot;,</span>
<span class="cm">   &quot;key3&quot;: &quot;val1,val2&quot;</span>
<span class="cm">}</span>
<span class="cm">queryToObject(</span>
<span class="cm">     &#39;key1=null&amp;key2=%5b1%2c2%2c3%5d&amp;key3=%5b%22val1%22%2c%22val2%22%5d&#39;</span>
<span class="cm">    ) =</span>
<span class="cm">{</span>
<span class="cm">   &quot;key1&quot;: &quot;null&quot;,</span>
<span class="cm">   &quot;key2&quot;: [</span>
<span class="cm">      1,</span>
<span class="cm">      2,</span>
<span class="cm">      3</span>
<span class="cm">   ],</span>
<span class="cm">   &quot;key3&quot;: [</span>
<span class="cm">      &quot;val1&quot;,</span>
<span class="cm">      &quot;val2&quot;</span>
<span class="cm">   ]</span>
<span class="cm">}</span>
<span class="cm">*/</span>
</pre></div>
</div>
</div>
<div class="section" id="getchar">
<h3>getchar<a class="headerlink" href="#getchar" title="Permalink to this headline">¬∂</a></h3>
<p>Get one or more characters from <code class="docutils literal notranslate"><span class="pre">stdin</span></code>.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">instr</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">getchar</span><span class="p">([</span><span class="nx">nchar</span><span class="p">]);</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">nchar</span></code> is an optional <span class="green">number</span>, the number of characters
to read from <code class="docutils literal notranslate"><span class="pre">stdin</span></code>.  The default is <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p>
<dl class="docutils">
<dt>Return Value:</dt>
<dd>A <span class="green">String</span> of length <code class="docutils literal notranslate"><span class="pre">nchars</span></code>.</dd>
<dt>Note:</dt>
<dd>If <code class="docutils literal notranslate"><span class="pre">stdin</span></code> is from an interactive terminal, execution
will be paused until <code class="docutils literal notranslate"><span class="pre">nchar</span></code> chars are input.  Unlike
<code class="docutils literal notranslate"><span class="pre">fread(stdin);</span></code> <a class="reference internal" href="#fread"><span class="std std-ref">below</span></a>, the terminal will be
set to return characters in without waiting for a newline.</dd>
</dl>
</div>
<div class="section" id="readfile">
<h3>readFile<a class="headerlink" href="#readfile" title="Permalink to this headline">¬∂</a></h3>
<p>Read the contents of a file.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">contents</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">readFile</span><span class="p">({</span>
   <span class="nx">file</span><span class="o">:</span> <span class="nx">filename</span>
   <span class="p">[,</span> <span class="nx">offset</span><span class="o">:</span> <span class="nx">offsetPos</span><span class="p">]</span>
   <span class="p">[,</span> <span class="nx">length</span><span class="o">:</span> <span class="nx">rLength</span><span class="p">]</span>
   <span class="p">[,</span> <span class="nx">returnString</span><span class="o">:</span> <span class="nx">return_str</span><span class="p">]</span>
<span class="p">});</span>

<span class="cm">/* or */</span>

<span class="kd">var</span> <span class="nx">contents</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="nx">filename</span> <span class="p">[,</span> <span class="nx">offsetPos</span> <span class="p">[,</span> <span class="nx">rLength</span><span class="p">]]</span> <span class="p">[,</span> <span class="nx">return_str</span><span class="p">]);</span>
</pre></div>
</div>
<p>Where values <code class="docutils literal notranslate"><span class="pre">filename</span></code> and optional values
<code class="docutils literal notranslate"><span class="pre">offsetPos</span></code>, <code class="docutils literal notranslate"><span class="pre">rLength</span></code> and/or <code class="docutils literal notranslate"><span class="pre">return_str</span></code> are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="19%" />
<col width="68%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Argument</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>filename</td>
<td><span class="green">String</span></td>
<td>Path to the file to be read</td>
</tr>
<tr class="row-odd"><td rowspan="2">offsetPos</td>
<td rowspan="2"><span class="green">Number</span></td>
<td>If positive, start position to read from beginning of file.</td>
</tr>
<tr class="row-even"><td>If negative, start position to read from end of file.</td>
</tr>
<tr class="row-odd"><td rowspan="2">rLength</td>
<td rowspan="2"><span class="green">Number</span></td>
<td>If greater than zero, amount in bytes to be read.</td>
</tr>
<tr class="row-even"><td>If 0 or negative, position from end of file to stop reading.</td>
</tr>
<tr class="row-odd"><td rowspan="2">return_str</td>
<td rowspan="2"><span class="green">Boolean</span></td>
<td>If not set, or <code class="docutils literal notranslate"><span class="pre">false</span></code>, return a <span class="green">Buffer</span>.</td>
</tr>
<tr class="row-even"><td>If <code class="docutils literal notranslate"><span class="pre">true</span></code>, return contents as a <span class="green">String</span>.
May be truncated if the file contains null characters.</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Return Value:</dt>
<dd><span class="green">Buffer</span> or <span class="green">String</span>.  The contents of the file.</dd>
</dl>
<p>Example:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">fprintf</span><span class="p">(</span><span class="s2">&quot;/tmp/file.txt&quot;</span><span class="p">,</span><span class="s2">&quot;This is a text file\n&quot;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">txt</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">readFile</span><span class="p">({</span>
   <span class="nx">filename</span><span class="o">:</span>  <span class="s2">&quot;/tmp/file.txt&quot;</span><span class="p">,</span>
   <span class="nx">offset</span><span class="o">:</span>    <span class="mi">10</span><span class="p">,</span>
   <span class="nx">length</span><span class="o">:</span>    <span class="o">-</span><span class="mi">6</span><span class="p">,</span>
   <span class="nx">retString</span><span class="o">:</span> <span class="kc">true</span>
<span class="p">});</span>

<span class="cm">/* or var txt = rampart.utils.readFile(&quot;/tmp/file.txt&quot;, 10, -6, true); */</span>

<span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">printf</span><span class="p">(</span><span class="s2">&quot;&#39;%s&#39;\n&quot;</span><span class="p">,</span> <span class="nx">txt</span><span class="p">);</span>

<span class="cm">/* expected output:</span>
<span class="cm">&#39;text&#39;</span>
<span class="cm">*/</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Note:</dt>
<dd>If <code class="docutils literal notranslate"><span class="pre">return_str</span></code> is <code class="docutils literal notranslate"><span class="pre">true</span></code> and <code class="docutils literal notranslate"><span class="pre">offsetPos</span></code> and/or <code class="docutils literal notranslate"><span class="pre">rLength</span></code> are
set, the returned <span class="green">String</span> may be shortened to ensure that the
return value is a valid UTF-8 string.  If that behavior is not desired,
returning a <span class="green">Buffer</span> and converting to a string with, e.g.
<a class="reference internal" href="#sprintf">sprintf</a>() or <a class="reference internal" href="#buffertostring">bufferToString</a>() will bypass the UTF-8
character/byte boundary check.</dd>
</dl>
</div>
<div class="section" id="trim">
<h3>trim<a class="headerlink" href="#trim" title="Permalink to this headline">¬∂</a></h3>
<p>Remove whitespace characters from the beginning and end of a <span class="green">String</span>.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">trimmed</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">trim</span><span class="p">(</span><span class="nx">str</span><span class="p">);</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">str</span></code> is a <span class="green">String</span>.</p>
<dl class="docutils">
<dt>Return Value:</dt>
<dd><span class="green">String</span>. <code class="docutils literal notranslate"><span class="pre">str</span></code> with whitespace removed from beginning and end.</dd>
</dl>
<p>Example:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">str</span> <span class="o">=</span> <span class="s2">&quot;\n a line of text \n&quot;</span><span class="p">;</span>
<span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">printf</span><span class="p">(</span><span class="s2">&quot;&#39;%s&#39;&quot;</span><span class="p">,</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">trim</span><span class="p">(</span><span class="nx">str</span><span class="p">));</span>
<span class="cm">/* expected output:</span>
<span class="cm">&#39;a line of text&#39;</span>
<span class="cm">*/</span>
</pre></div>
</div>
</div>
<div class="section" id="stat">
<h3>stat<a class="headerlink" href="#stat" title="Permalink to this headline">¬∂</a></h3>
<p>Return information on a file.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">st</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">stat</span><span class="p">(</span><span class="nx">file</span><span class="p">);</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">file</span></code> is a <span class="green">String</span> (name of file).</p>
<dl class="docutils">
<dt>Return Value:</dt>
<dd><span class="green">Boolean</span>/<span class="green">Object</span>. <code class="docutils literal notranslate"><span class="pre">false</span></code> if file does not exist.  Otherwise an <span class="green">Object</span> with the following
properties:</dd>
</dl>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="s2">&quot;dev&quot;</span><span class="o">:</span>               <span class="nb">Number</span><span class="p">,</span>
   <span class="s2">&quot;ino&quot;</span><span class="o">:</span>               <span class="nb">Number</span><span class="p">,</span>
   <span class="s2">&quot;mode&quot;</span><span class="o">:</span>              <span class="nb">Number</span><span class="p">,</span>
   <span class="s2">&quot;nlink&quot;</span><span class="o">:</span>             <span class="nb">Number</span><span class="p">,</span>
   <span class="s2">&quot;uid&quot;</span><span class="o">:</span>               <span class="nb">Number</span><span class="p">,</span>
   <span class="s2">&quot;gid&quot;</span><span class="o">:</span>               <span class="nb">Number</span><span class="p">,</span>
   <span class="s2">&quot;rdev&quot;</span><span class="o">:</span>              <span class="nb">Number</span><span class="p">,</span>
   <span class="s2">&quot;size&quot;</span><span class="o">:</span>              <span class="nb">Number</span><span class="p">,</span>
   <span class="s2">&quot;blksize&quot;</span><span class="o">:</span>           <span class="nb">Number</span><span class="p">,</span>
   <span class="s2">&quot;blocks&quot;</span><span class="o">:</span>            <span class="nb">Number</span><span class="p">,</span>
   <span class="s2">&quot;atime&quot;</span><span class="o">:</span>             <span class="nb">Date</span><span class="p">,</span>
   <span class="s2">&quot;mtime&quot;</span><span class="o">:</span>             <span class="nb">Date</span><span class="p">,</span>
   <span class="s2">&quot;ctime&quot;</span><span class="o">:</span>             <span class="nb">Date</span><span class="p">,</span>
   <span class="s2">&quot;readable&quot;</span><span class="o">:</span>          <span class="nb">Boolean</span><span class="p">,</span>
   <span class="s2">&quot;writable&quot;</span><span class="o">:</span>          <span class="nb">Boolean</span><span class="p">,</span>
   <span class="s2">&quot;executable&quot;</span><span class="o">:</span>        <span class="nb">Boolean</span><span class="p">,</span>
   <span class="s2">&quot;owner&quot;</span><span class="o">:</span>             <span class="nb">String</span><span class="p">,</span>
   <span class="s2">&quot;group&quot;</span><span class="o">:</span>             <span class="nb">String</span><span class="p">,</span>
   <span class="s2">&quot;isBlockDevice&quot;</span><span class="o">:</span>     <span class="nb">Boolean</span><span class="p">,</span>
   <span class="s2">&quot;isCharacterDevice&quot;</span><span class="o">:</span> <span class="nb">Boolean</span><span class="p">,</span>
   <span class="s2">&quot;isDirectory&quot;</span><span class="o">:</span>       <span class="nb">Boolean</span><span class="p">,</span>
   <span class="s2">&quot;isFIFO&quot;</span><span class="o">:</span>            <span class="nb">Boolean</span><span class="p">,</span>
   <span class="s2">&quot;isFile&quot;</span><span class="o">:</span>            <span class="nb">Boolean</span><span class="p">,</span>
   <span class="s2">&quot;isSocket&quot;</span><span class="o">:</span>          <span class="nb">Boolean</span><span class="p">,</span>
   <span class="s2">&quot;permissions&quot;</span><span class="o">:</span>       <span class="nb">String</span>  <span class="cm">/* i.e. &quot;-rw-r--r--&quot; */</span>
<span class="p">}</span>
</pre></div>
</div>
<p>See <a class="reference external" href="https://man7.org/linux/man-pages/man2/stat.2.html">stat (2)</a> for the
meaning of each property.  The <code class="docutils literal notranslate"><span class="pre">is*</span></code> <span class="green">Booleans</span> are set to <code class="docutils literal notranslate"><span class="pre">true</span></code> if the
corresponding file property is true.</p>
<p>Example:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">st</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">stat</span><span class="p">(</span><span class="s2">&quot;/tmp/file.txt&quot;</span><span class="p">);</span>

<span class="k">if</span><span class="p">(</span><span class="nx">st</span><span class="p">)</span> <span class="p">{</span>
   <span class="cm">/* print file mode as octal number */</span>
   <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">printf</span><span class="p">(</span><span class="s2">&quot;%o\n&quot;</span><span class="p">,</span> <span class="nx">st</span><span class="p">.</span><span class="nx">mode</span> <span class="o">&amp;</span> <span class="mi">0777</span><span class="p">)</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;file /tmp.file.txt does not exist&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="cm">/* expected output: 644 */</span>
</pre></div>
</div>
</div>
<div class="section" id="lstat">
<h3>lstat<a class="headerlink" href="#lstat" title="Permalink to this headline">¬∂</a></h3>
<p>Same as <a class="reference internal" href="#stat">stat</a>() except if <code class="docutils literal notranslate"><span class="pre">file</span></code> is a link, return information about the link itself.</p>
<dl class="docutils">
<dt>Return Value:</dt>
<dd>Same as <a class="reference internal" href="#stat">stat</a>() with the addition of the property
<code class="docutils literal notranslate"><span class="pre">isSymbolicLink</span></code> which is set <code class="docutils literal notranslate"><span class="pre">true</span></code> if the file is a symbolic link.
<code class="docutils literal notranslate"><span class="pre">readable</span></code> and <code class="docutils literal notranslate"><span class="pre">writable</span></code> refer to the link, not the target.</dd>
</dl>
</div>
<div class="section" id="exec">
<h3>exec<a class="headerlink" href="#exec" title="Permalink to this headline">¬∂</a></h3>
<p>Run an executable file.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">ret</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">command</span> <span class="p">[,</span> <span class="nx">options</span><span class="p">]</span> <span class="p">[,</span><span class="nx">arg1</span><span class="p">,</span> <span class="nx">arg2</span><span class="p">,</span> <span class="p">...,</span> <span class="nx">argn</span><span class="p">]</span> <span class="p">);</span>
</pre></div>
</div>
<p>Where:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">command</span></code> - <span class="green">String</span>. An absolute path to an executable or the name of
an executable that may be found in the current <code class="docutils literal notranslate"><span class="pre">PATH</span></code> environment variable.</li>
<li><code class="docutils literal notranslate"><span class="pre">options</span></code> - <span class="green">Object</span>. Containing the following properties:<ul>
<li><code class="docutils literal notranslate"><span class="pre">timeout</span></code> - <span class="green">Number</span>. Maximum amount of time in milliseconds before
the process is automatically killed.  Valid if <code class="docutils literal notranslate"><span class="pre">background</span></code> is unset
or <code class="docutils literal notranslate"><span class="pre">false</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">killSignal</span></code> - <span class="green">Number</span>. If timeout is reached, use this
signal.  Valid if <code class="docutils literal notranslate"><span class="pre">background</span></code> is unset
or <code class="docutils literal notranslate"><span class="pre">false</span></code> and a <code class="docutils literal notranslate"><span class="pre">timeout</span></code> value is set.</li>
<li><code class="docutils literal notranslate"><span class="pre">background</span></code> - <span class="green">Boolean</span>.  Whether to execute detached and return
immediately.  If <code class="docutils literal notranslate"><span class="pre">true</span></code>, <code class="docutils literal notranslate"><span class="pre">stdout</span></code> and <code class="docutils literal notranslate"><span class="pre">stderr</span></code> below will be set to <code class="docutils literal notranslate"><span class="pre">null</span></code>.  Any <code class="docutils literal notranslate"><span class="pre">timeout</span></code>
value is ignored.</li>
<li><code class="docutils literal notranslate"><span class="pre">env</span></code> - <span class="green">Object</span>. Key/value pairs to be used as environment variables for the executed process.
Default, if not provided is <a class="reference internal" href="rampart-main.html#env"><span class="std std-ref">process.env</span></a>.  An empty <span class="green">Object</span>
(<code class="docutils literal notranslate"><span class="pre">{}</span></code>) removes all environment variables.</li>
<li><code class="docutils literal notranslate"><span class="pre">appendEnv</span></code> - <span class="green">Boolean</span>.  If <code class="docutils literal notranslate"><span class="pre">false</span></code> (the default),
only the environment variables given in <code class="docutils literal notranslate"><span class="pre">env</span></code> will be available.  If
<code class="docutils literal notranslate"><span class="pre">true</span></code>, variables provided in <code class="docutils literal notranslate"><span class="pre">env</span></code> will be appended to <a class="reference internal" href="rampart-main.html#env"><span class="std std-ref">process.env</span></a>.
Duplicate keys in <a class="reference internal" href="rampart-main.html#env"><span class="std std-ref">process.env</span></a> are replaced with the value from <code class="docutils literal notranslate"><span class="pre">env</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">stdin</span></code> - <span class="green">String</span> or <span class="green">Buffer</span>.  If specified, the content
of the <span class="green">String</span> or <span class="green">Buffer</span> is piped to the command as stdin.</li>
<li><code class="docutils literal notranslate"><span class="pre">returnBuffer</span></code> - <span class="green">Boolean</span>.  Whether content is returned in a
<span class="green">Buffer</span> rather than a <span class="green">String</span>.  Useful for capturing
binary data output.</li>
<li><code class="docutils literal notranslate"><span class="pre">args</span></code> - <span class="green">Array</span>.  An array of arguments to be passed to the
executable.  If arguments are also given as parameters to <code class="docutils literal notranslate"><span class="pre">exec()</span></code>,
the <span class="green">Array</span> of arguments are appended.</li>
<li><code class="docutils literal notranslate"><span class="pre">changeDirectory</span></code> - <span class="green">String</span>.  Change the working directory
to value before executing.</li>
<li><code class="docutils literal notranslate"><span class="pre">cd</span></code> - Alias for <code class="docutils literal notranslate"><span class="pre">changeDirectory</span></code> .</li>
</ul>
</li>
<li><code class="docutils literal notranslate"><span class="pre">argn</span></code> - <span class="green">String</span>/<span class="green">Number</span>/<span class="green">Object</span>/<span class="green">Boolean</span>/<span class="green">Null</span> - Arguments to be passed to
<code class="docutils literal notranslate"><span class="pre">command</span></code>.  Non-Strings are converted to a <span class="green">String</span> (e.g. ‚Äútrue‚Äù, ‚Äúnull‚Äù,
‚Äú42‚Äù or for <span class="green">Object</span>, the equivalent of <code class="docutils literal notranslate"><span class="pre">JSON.stringify(obj)</span></code>).</li>
</ul>
<dl class="docutils">
<dt>Return Value:</dt>
<dd><p class="first"><span class="green">Object</span>.  Properties as follows:</p>
<ul class="last simple">
<li><code class="docutils literal notranslate"><span class="pre">stdout</span></code> - <span class="green">String</span>. Output of command if <code class="docutils literal notranslate"><span class="pre">background</span></code> is not set <code class="docutils literal notranslate"><span class="pre">true</span></code>.
Otherwise <code class="docutils literal notranslate"><span class="pre">null</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">stderr</span></code> - <span class="green">String</span>. stderr output of command if <code class="docutils literal notranslate"><span class="pre">background</span></code> is not set <code class="docutils literal notranslate"><span class="pre">true</span></code>.
Otherwise <code class="docutils literal notranslate"><span class="pre">null</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">exitStatus</span></code> - <span class="green">Number</span>.  The returned exit status of the command.</li>
<li><code class="docutils literal notranslate"><span class="pre">timedOut</span></code> - <span class="green">Boolean</span>.  Set true if the program was killed after
<code class="docutils literal notranslate"><span class="pre">timeout</span></code> milliseconds has elapsed.</li>
<li><code class="docutils literal notranslate"><span class="pre">pid</span></code> - <span class="green">Number</span>. Process id of the executed command.</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="shell">
<h3>shell<a class="headerlink" href="#shell" title="Permalink to this headline">¬∂</a></h3>
<p>Execute <span class="green">String</span> in a bash shell. Equivalent to
<code class="docutils literal notranslate"><span class="pre">rampart.utils.exec(&quot;bash&quot;,</span> <span class="pre">&quot;-c&quot;,</span> <span class="pre">shellcmd);</span></code>.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">ret</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">shell</span><span class="p">(</span><span class="nx">shellcmd</span><span class="p">[,</span> <span class="nx">options</span><span class="p">]);</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">shellcmd</span></code> is a <span class="green">String</span> containing the command and arguments to be
passed to bash and <code class="docutils literal notranslate"><span class="pre">options</span></code> are the same as specified for <a class="reference internal" href="#exec">exec</a>.</p>
<dl class="docutils">
<dt>Return Value:</dt>
<dd>Same as <a class="reference internal" href="#exec">exec</a>().</dd>
</dl>
<p>Example:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">ret</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">shell</span><span class="p">(</span><span class="s1">&#39;echo -n &quot;hello&quot;; echo &quot;hi&quot; 1&gt;&amp;2;&#39;</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">ret</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">3</span><span class="p">));</span>

<span class="cm">/* expected output:</span>
<span class="cm">{</span>
<span class="cm">   &quot;stdout&quot;: &quot;hello&quot;,</span>
<span class="cm">   &quot;stderr&quot;: &quot;hi\n&quot;,</span>
<span class="cm">   &quot;timedOut&quot;: false,</span>
<span class="cm">   &quot;exitStatus&quot;: 0,</span>
<span class="cm">   &quot;pid&quot;: 24658</span>
<span class="cm">}</span>
<span class="cm">*/</span>
</pre></div>
</div>
</div>
<div class="section" id="fork">
<h3>fork<a class="headerlink" href="#fork" title="Permalink to this headline">¬∂</a></h3>
<p>Fork the current process.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">pid</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">fork</span><span class="p">([</span><span class="nx">pipe</span><span class="p">,</span> <span class="nx">pipe2</span><span class="p">,</span> <span class="p">...,</span> <span class="nx">pipeX</span><span class="p">]);</span>

<span class="k">if</span><span class="p">(</span><span class="nx">pid</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
   <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">fprintf</span><span class="p">(</span><span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">stderr</span><span class="p">,</span> <span class="s2">&quot;error forking\n&quot;</span><span class="p">);</span>

<span class="k">if</span><span class="p">(</span><span class="nx">pid</span><span class="p">)</span> <span class="p">{</span>
   <span class="c1">//parent</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
   <span class="c1">//child</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">pipeX</span></code> is one or several pipes created with <a class="reference internal" href="#newpipe">newPipe</a> below.</p>
<dl class="docutils">
<dt>Return Value:</dt>
<dd>A <span class="green">Number</span> - The pid of the child in the parent process, <code class="docutils literal notranslate"><span class="pre">0</span></code> in
the child process and <code class="docutils literal notranslate"><span class="pre">-1</span></code> if there is an error and fork failed.</dd>
<dt>Note:</dt>
<dd><code class="docutils literal notranslate"><span class="pre">fork</span></code> will throw an error if there are any threads running at the
time of the fork, either from <code class="docutils literal notranslate"><span class="pre">rampart.thread</span></code> or <code class="docutils literal notranslate"><span class="pre">rampart-server</span></code>.
Threads, however, can be created after the fork in either the child
or parent process.</dd>
</dl>
</div>
<div class="section" id="newpipe">
<h3>newPipe<a class="headerlink" href="#newpipe" title="Permalink to this headline">¬∂</a></h3>
<p>Create a bi-directional pipe for passing variables between processes created
with <a class="reference internal" href="#fork">fork</a> above.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">pipe</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">newPipe</span><span class="p">();</span>

<span class="kd">var</span> <span class="nx">pid</span> <span class="o">=</span> <span class="nx">fork</span><span class="p">(</span><span class="nx">pipe</span><span class="p">);</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Return Value:</dt>
<dd><p class="first">An <span class="green">Object</span> of <span class="green">Functions</span>:</p>
<ul class="last simple">
<li><code class="docutils literal notranslate"><span class="pre">write(data)</span></code> - write to the pipe, where data is any variable which
can be serialized using <code class="docutils literal notranslate"><span class="pre">CBOR</span></code>.  Return value is the number of bytes
written. Note: writes may block if the pipe is full until the reading
process reads with one of the two read functions below.  Throws an
error if pipe has been closed.</li>
<li><code class="docutils literal notranslate"><span class="pre">read([function])</span></code>  - perform a blocking read of data sent from
another process using <code class="docutils literal notranslate"><span class="pre">write()</span></code> above.  If a function is provided
(i.e. <code class="docutils literal notranslate"><span class="pre">function(value,</span> <span class="pre">error){}</span></code>) the value or error will be passed
to that callback (with the other being undefined).  Return value will
be undefined. If no function is provided, the return value will be an
<span class="green">Object</span> with either <code class="docutils literal notranslate"><span class="pre">value</span></code> or <code class="docutils literal notranslate"><span class="pre">error</span></code> set.</li>
<li><code class="docutils literal notranslate"><span class="pre">onRead(function)</span></code> - same as <code class="docutils literal notranslate"><span class="pre">read</span></code>, except that a
<span class="green">Function</span> is required, the call is non-blocking and the
callback <span class="green">Function</span> will be called in the event loop each time
data is available.  On error, the pipe will close and the event will be
removed.</li>
<li><code class="docutils literal notranslate"><span class="pre">close()</span></code> - close the pipe.  Any further reads or writes from either
process will produce or throw an error.</li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">pipe</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">newPipe</span><span class="p">();</span>

<span class="c1">// fork and set the pipe for parent and child processes</span>
<span class="kd">var</span> <span class="nx">pid</span> <span class="o">=</span> <span class="nx">fork</span><span class="p">(</span><span class="nx">pipe</span><span class="p">);</span>

<span class="k">if</span><span class="p">(</span><span class="nx">pid</span> <span class="o">==-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
   <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">fprintf</span><span class="p">(</span><span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">stderr</span><span class="p">,</span> <span class="s2">&quot;error piping\n&quot;</span><span class="p">);</span>
   <span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">if</span><span class="p">(</span><span class="nx">pid</span><span class="p">)</span> <span class="p">{</span>
   <span class="c1">//parent</span>

   <span class="nx">pipe</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="s2">&quot;My first message&quot;</span><span class="p">);</span>
   <span class="nx">pipe</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="s2">&quot;My second message&quot;</span><span class="p">);</span>

<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
   <span class="c1">//child</span>

   <span class="kd">var</span> <span class="nx">msg</span> <span class="o">=</span> <span class="nx">pipe</span><span class="p">.</span><span class="nx">read</span><span class="p">();</span>
   <span class="k">if</span><span class="p">(</span><span class="nx">msg</span><span class="p">.</span><span class="nx">err</span><span class="p">)</span>
      <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">fprintf</span><span class="p">(</span><span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">stderr</span><span class="p">,</span> <span class="s2">&quot;error reading- %s\n&quot;</span><span class="p">,</span> <span class="nx">msg</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
   <span class="k">else</span>
      <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">printf</span><span class="p">(</span><span class="s2">&quot;msg = &#39;%s&#39;\n&quot;</span><span class="p">,</span> <span class="nx">msg</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>

   <span class="c1">//run non-blocking in event loop</span>
   <span class="nx">pipe</span><span class="p">.</span><span class="nx">onRead</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">val</span><span class="p">,</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
         <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">fprintf</span><span class="p">(</span><span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">stderr</span><span class="p">,</span> <span class="s2">&quot;read event: error reading- %s\n&quot;</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
      <span class="k">else</span>
         <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">printf</span><span class="p">(</span><span class="s2">&quot;read event: msg = &#39;%s&#39;\n&quot;</span><span class="p">,</span> <span class="nx">val</span><span class="p">);</span>
   <span class="p">});</span>

<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="daemon">
<h3>daemon<a class="headerlink" href="#daemon" title="Permalink to this headline">¬∂</a></h3>
<p>Same as <a class="reference internal" href="#fork">fork</a> above, except it double forks, detaches and creates its own session.  Thus the child process
will continue to run after the parent and the controlling terminal exit.</p>
</div>
<div class="section" id="forkpty">
<h3>forkpty<a class="headerlink" href="#forkpty" title="Permalink to this headline">¬∂</a></h3>
<p>Run an executable file in a pseudo-terminal with unbuffered IO.  IO is
performed asynchronously in the event loop of the current thread.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">pty</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">forkpty</span><span class="p">(</span><span class="nx">command</span> <span class="p">[,</span> <span class="nx">options</span><span class="p">]</span> <span class="p">[,</span><span class="nx">arg1</span><span class="p">,</span> <span class="nx">arg2</span><span class="p">,</span> <span class="p">...,</span> <span class="nx">argn</span><span class="p">]</span> <span class="p">);</span>
</pre></div>
</div>
<p>Where:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">command</span></code> - <span class="green">String</span>. An absolute path to an executable or the name of
an executable that may be found in the current <code class="docutils literal notranslate"><span class="pre">PATH</span></code> environment variable.</li>
<li><code class="docutils literal notranslate"><span class="pre">options</span></code> - <span class="green">Object</span>. Containing the following properties:<ul>
<li><code class="docutils literal notranslate"><span class="pre">env</span></code> - <span class="green">Object</span>. Key/value pairs to be used as environment variables for the executed process.
Default, if not provided is <a class="reference internal" href="rampart-main.html#env"><span class="std std-ref">process.env</span></a>.  An empty <span class="green">Object</span>
(<code class="docutils literal notranslate"><span class="pre">{}</span></code>) removes all environment variables.</li>
<li><code class="docutils literal notranslate"><span class="pre">appendEnv</span></code> - <span class="green">Boolean</span>.  If <code class="docutils literal notranslate"><span class="pre">false</span></code> (the default),
only the environment variables given in <code class="docutils literal notranslate"><span class="pre">env</span></code> will be available.  If
<code class="docutils literal notranslate"><span class="pre">true</span></code>, variables provided in <code class="docutils literal notranslate"><span class="pre">env</span></code> will be appended to <a class="reference internal" href="rampart-main.html#env"><span class="std std-ref">process.env</span></a>.
Duplicate keys in <a class="reference internal" href="rampart-main.html#env"><span class="std std-ref">process.env</span></a> are replaced with the value from <code class="docutils literal notranslate"><span class="pre">env</span></code>.</li>
</ul>
</li>
<li><code class="docutils literal notranslate"><span class="pre">argn</span></code> - <span class="green">String</span>/<span class="green">Number</span>/<span class="green">Object</span>/<span class="green">Boolean</span>/<span class="green">Null</span> - Arguments to be passed to
<code class="docutils literal notranslate"><span class="pre">command</span></code>.  Non-Strings are converted to a <span class="green">String</span> (e.g. ‚Äútrue‚Äù, ‚Äúnull‚Äù,
‚Äú42‚Äù or for <span class="green">Object</span>, the equivalent of <code class="docutils literal notranslate"><span class="pre">JSON.stringify(obj)</span></code>).</li>
</ul>
<dl class="docutils">
<dt>Return Value:</dt>
<dd><p class="first"><span class="green">Object</span>.  Properties as follows:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">read</span></code> - <span class="green">Function</span>.  Read data from the stdout of the executed
process.</p>
<blockquote>
<div><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">pty</span><span class="p">.</span><span class="nx">read</span><span class="p">([</span><span class="nx">buffersize</span> <span class="p">[,</span> <span class="nx">maxread</span><span class="p">]]</span> <span class="p">[,</span> <span class="nx">retstring</span><span class="p">]);</span>
</pre></div>
</div>
<p>Where: <code class="docutils literal notranslate"><span class="pre">buffersize</span></code> defaults to <code class="docutils literal notranslate"><span class="pre">4096</span></code>, <code class="docutils literal notranslate"><span class="pre">maxread</span></code> defaults to
unlimited and <code class="docutils literal notranslate"><span class="pre">retstring</span></code> (default <code class="docutils literal notranslate"><span class="pre">false</span></code> for
<span class="green">Buffer</span>) is a <span class="green">Boolean</span> - whether the return
contents should be converted to <span class="green">String</span>.</p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">write</span></code> - <span class="green">Function</span>. Write data to the stdin of the executed
process.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">pty</span><span class="p">.</span><span class="nx">write</span><span class="p">([</span><span class="nx">buffer</span><span class="o">|</span><span class="nx">string</span><span class="p">]);</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">resize</span></code> - <span class="green">Function</span>. Set a new size for the pseudo-terminal.</p>
<blockquote>
<div><blockquote>
<div><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">pty</span><span class="p">.</span><span class="nx">resize</span><span class="p">(</span><span class="nx">width</span><span class="p">,</span> <span class="nx">height</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>Where: <code class="docutils literal notranslate"><span class="pre">width</span></code> and <code class="docutils literal notranslate"><span class="pre">height</span></code> are <span class="green">Numbers</span> - number of
character rows and columns.</p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">on</span></code> - <span class="green">Function</span>:  Two events are currently allowed:
<code class="docutils literal notranslate"><span class="pre">&quot;data&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;close&quot;</span></code>.  If, <code class="docutils literal notranslate"><span class="pre">&quot;data&quot;</span></code> is specified, when new data
is available to be read, the provided callback function will be called.
If <code class="docutils literal notranslate"><span class="pre">&quot;close&quot;</span></code> is specified, the provided callback function will be
called when the process exits.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">pty</span><span class="p">.</span><span class="nx">on</span><span class="p">([</span><span class="s1">&#39;data&#39;</span><span class="o">|</span><span class="s1">&#39;close&#39;</span><span class="p">],</span> <span class="nx">callback</span><span class="p">);</span>
</pre></div>
</div>
</li>
</ul>
<p>If there is an initial error executing <code class="docutils literal notranslate"><span class="pre">command</span></code>, <code class="docutils literal notranslate"><span class="pre">forkpty()</span></code> will throw an
error.  When the command exits, the functions in the return object will be deleted.
Therefore a check should be run before accessing any functions in case the pty has
closed:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">pty</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">forkpty</span><span class="p">(</span><span class="nx">command</span> <span class="p">[,</span> <span class="nx">options</span><span class="p">]</span> <span class="p">[,</span><span class="nx">arg1</span><span class="p">,</span> <span class="nx">arg2</span><span class="p">,</span> <span class="p">...,</span> <span class="nx">argn</span><span class="p">]</span> <span class="p">);</span>

<span class="k">if</span><span class="p">(</span><span class="nx">pty</span><span class="p">.</span><span class="nx">write</span><span class="p">)</span>
   <span class="nx">pty</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">msg</span><span class="p">);</span>
<span class="k">else</span>
   <span class="nx">do_cleanup</span><span class="p">();</span>
</pre></div>
</div>
<p class="last">An example for using <code class="docutils literal notranslate"><span class="pre">forkpty()</span></code> with websockets to run a terminal in
a web browser can be found
<a class="reference external" href="https://github.com/aflin/rampart/tree/main/unsupported_extras/forkpty-term">here</a>.</p>
</dd>
</dl>
</div>
<div class="section" id="kill">
<h3>kill<a class="headerlink" href="#kill" title="Permalink to this headline">¬∂</a></h3>
<p>Terminate a process or send a signal.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">ret</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">kill</span><span class="p">(</span><span class="nx">pid</span> <span class="p">[,</span> <span class="nx">signal</span><span class="p">[,</span> <span class="nx">throwOnError</span><span class="p">]]);</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Where:</dt>
<dd><ul class="first last simple">
<li><code class="docutils literal notranslate"><span class="pre">pid</span></code> is a <span class="green">Number</span>, the process id of process which will
receive the signal.</li>
<li><code class="docutils literal notranslate"><span class="pre">signal</span></code> is a <span class="green">Number</span>, or <span class="green">String</span>, the signal to send.
If <code class="docutils literal notranslate"><span class="pre">signal</span></code> is not specified, <code class="docutils literal notranslate"><span class="pre">15</span></code> (<code class="docutils literal notranslate"><span class="pre">SIGTERM</span></code>) is used.  See manual
page for kill(1) for a list of signals, which may vary by platform.  Setting
<code class="docutils literal notranslate"><span class="pre">signal</span></code> to <code class="docutils literal notranslate"><span class="pre">0</span></code> sends no signal, but checks for the existence of the
process identified by <code class="docutils literal notranslate"><span class="pre">pid</span></code>. <code class="docutils literal notranslate"><span class="pre">signal</span></code> may also be a <span class="green">String</span>, a well
known signal such as <code class="docutils literal notranslate"><span class="pre">&quot;SIGTERM&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;SIGUSR1&quot;</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">throwOnError</span></code> - <span class="green">Boolean</span> - whether to throw an error with a specified
reason upon failure.  Default is <code class="docutils literal notranslate"><span class="pre">false</span></code>.</li>
</ul>
</dd>
<dt>Return Value:</dt>
<dd><span class="green">Boolean</span>.  <code class="docutils literal notranslate"><span class="pre">true</span></code> if the signal was successfully sent.  If <code class="docutils literal notranslate"><span class="pre">throwOnError</span></code>
is not <code class="docutils literal notranslate"><span class="pre">true</span></code>, will return <code class="docutils literal notranslate"><span class="pre">false</span></code> if there was an error or process does not exist.</dd>
</dl>
<p>Example:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">ret</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="s2">&quot;sleep&quot;</span><span class="p">,</span> <span class="s2">&quot;100&quot;</span><span class="p">,</span> <span class="p">{</span><span class="nx">background</span><span class="o">:</span><span class="kc">true</span><span class="p">});</span>
<span class="kd">var</span> <span class="nx">pid</span><span class="o">=</span><span class="nx">ret</span><span class="p">.</span><span class="nx">pid</span><span class="p">;</span>

<span class="k">if</span> <span class="p">(</span><span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">kill</span><span class="p">(</span><span class="nx">pid</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;process is still running&quot;</span><span class="p">);</span>
    <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">kill</span><span class="p">(</span><span class="nx">pid</span><span class="p">);</span>
    <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">kill</span><span class="p">(</span><span class="nx">pid</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span>
       <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;and now is dead&quot;</span><span class="p">);</span>
<span class="p">}</span> <span class="k">else</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;not running&quot;</span><span class="p">);</span>
<span class="cm">/* expected output:</span>
<span class="cm">   process is still running</span>
<span class="cm">   and now is dead</span>
<span class="cm">*/</span>
</pre></div>
</div>
</div>
<div class="section" id="getcwd">
<h3>getcwd<a class="headerlink" href="#getcwd" title="Permalink to this headline">¬∂</a></h3>
<p>Return the current working directory as a <span class="green">String</span>.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">getcwd</span><span class="p">();</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Return Value:</dt>
<dd>A <span class="green">String</span>, the current working directory of the script.</dd>
</dl>
</div>
<div class="section" id="chdir">
<h3>chdir<a class="headerlink" href="#chdir" title="Permalink to this headline">¬∂</a></h3>
<p>Change the current working directory.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">chdir</span><span class="p">(</span><span class="nx">path</span><span class="p">);</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">path</span></code> is a <span class="green">String</span>, the location of the new working
directory.  This command throws an error if it fails to change to the
specified directory.</p>
<dl class="docutils">
<dt>Return Value:</dt>
<dd><code class="docutils literal notranslate"><span class="pre">undefined</span></code>.</dd>
</dl>
</div>
<div class="section" id="mkdir">
<h3>mkdir<a class="headerlink" href="#mkdir" title="Permalink to this headline">¬∂</a></h3>
<p>Create a directory.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">mkdir</span><span class="p">(</span><span class="nx">path</span> <span class="p">[,</span> <span class="nx">mode</span><span class="p">]);</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">path</span></code> is a <span class="green">String</span>, the directory to be created and <code class="docutils literal notranslate"><span class="pre">mode</span></code> is a
<span class="green">Number</span> or <span class="green">String</span>, the octal permissions mode. Any parent directories which
do not exist will also be created.  Throws error if lacking permissions or
if another error was encountered.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">mode</span></code> is normally given as an octal.  As such it can be, e.g.,
<code class="docutils literal notranslate"><span class="pre">0755</span></code> (octal number) or <code class="docutils literal notranslate"><span class="pre">&quot;755&quot;</span></code> (<span class="green">String</span> representation of an octal
number), but <code class="docutils literal notranslate"><span class="pre">755</span></code>, as a decimal number will give the octal <code class="docutils literal notranslate"><span class="pre">01363</span></code>,
which is likely not what was intended.</p>
<dl class="docutils">
<dt>Return Value:</dt>
<dd><code class="docutils literal notranslate"><span class="pre">undefined</span></code>.</dd>
</dl>
</div>
<div class="section" id="rmdir">
<h3>rmdir<a class="headerlink" href="#rmdir" title="Permalink to this headline">¬∂</a></h3>
<p>Remove an empty directory.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">rmdir</span><span class="p">(</span><span class="nx">path</span> <span class="p">[,</span> <span class="nx">recurse</span><span class="p">]);</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">path</span></code> is a <span class="green">String</span>, the directory to be removed and <code class="docutils literal notranslate"><span class="pre">recurse</span></code> is an
optional <span class="green">Boolean</span>, which if <code class="docutils literal notranslate"><span class="pre">true</span></code>, parent directories explicitly present in
<code class="docutils literal notranslate"><span class="pre">path</span></code> will also be removed.  Throws an error if the directory cannot be
removed (.e.g., not empty or lacking permission).</p>
<dl class="docutils">
<dt>Return Value:</dt>
<dd><code class="docutils literal notranslate"><span class="pre">undefined</span></code>.</dd>
</dl>
<p>Example:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="cm">/* make the following directories in the</span>
<span class="cm">   current working directory             */</span>
<span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">mkdir</span><span class="p">(</span><span class="s2">&quot;p1/p2/p3&quot;</span><span class="p">,</span><span class="mi">0755</span><span class="p">);</span>

<span class="cm">/* remove the directories recursively */</span>
<span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">rmdir</span><span class="p">(</span><span class="s2">&quot;p1/p2/p3&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="readdir">
<h3>readDir<a class="headerlink" href="#readdir" title="Permalink to this headline">¬∂</a></h3>
<p>Get listing of directory files.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">files</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">readdir</span><span class="p">(</span><span class="nx">path</span> <span class="p">[,</span> <span class="nx">showhidden</span><span class="p">]);</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">path</span></code> is a <span class="green">String</span>, the directory whose content will be listed and
<code class="docutils literal notranslate"><span class="pre">showhidden</span></code> is a <span class="green">Boolean</span>, which if <code class="docutils literal notranslate"><span class="pre">true</span></code>, files or directories
beginning with <code class="docutils literal notranslate"><span class="pre">.</span></code> (hidden files) will be included in the return value.</p>
<dl class="docutils">
<dt>Return Value:</dt>
<dd><span class="green">Array</span>.  An <span class="green">Array</span> of <span class="green">Strings</span>, each filename in the directory.</dd>
</dl>
</div>
<div class="section" id="copyfile">
<h3>copyFile<a class="headerlink" href="#copyfile" title="Permalink to this headline">¬∂</a></h3>
<p>Make a copy of a file.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">copyFile</span><span class="p">({</span><span class="nx">src</span><span class="o">:</span> <span class="nx">source</span><span class="p">,</span> <span class="nx">dest</span><span class="o">:</span> <span class="nx">destination</span> <span class="p">[,</span> <span class="nx">overwrite</span><span class="o">:</span> <span class="nx">overWrite</span><span class="p">]});</span>

<span class="cm">/* or */</span>

<span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">copyFile</span><span class="p">(</span><span class="nx">source</span><span class="p">,</span> <span class="nx">destination</span> <span class="p">[,</span> <span class="nx">overWrite</span><span class="p">]);</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">source</span></code> is a <span class="green">String</span>, the file to be copied, <code class="docutils literal notranslate"><span class="pre">destination</span></code> is a
<span class="green">String</span>, the name of the target file and optional <code class="docutils literal notranslate"><span class="pre">overWrite</span></code> is a <span class="green">Boolean</span>
which if <code class="docutils literal notranslate"><span class="pre">true</span></code> will overwrite <code class="docutils literal notranslate"><span class="pre">destination</span></code> if it exists.</p>
<dl class="docutils">
<dt>Return Value:</dt>
<dd><code class="docutils literal notranslate"><span class="pre">undefined</span></code>.</dd>
</dl>
</div>
<div class="section" id="rmfile">
<h3>rmFile<a class="headerlink" href="#rmfile" title="Permalink to this headline">¬∂</a></h3>
<p>Delete a file.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">rmFile</span><span class="p">(</span><span class="nx">filename</span><span class="p">);</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">filename</span></code> is a <span class="green">String</span>, the name of the file to be removed.</p>
<dl class="docutils">
<dt>Return Value:</dt>
<dd><code class="docutils literal notranslate"><span class="pre">undefined</span></code>.</dd>
</dl>
</div>
<div class="section" id="link">
<h3>link<a class="headerlink" href="#link" title="Permalink to this headline">¬∂</a></h3>
<p>Create a hard link.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">link</span><span class="p">({</span><span class="nx">src</span><span class="o">:</span> <span class="nx">sourceName</span><span class="p">,</span> <span class="nx">target</span><span class="o">:</span> <span class="nx">targetName</span><span class="p">});</span>

<span class="cm">/* or */</span>

<span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">link</span><span class="p">(</span><span class="nx">sourceName</span><span class="p">,</span> <span class="nx">targetName</span><span class="p">);</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">sourceName</span></code> is the existing file and <code class="docutils literal notranslate"><span class="pre">targetName</span></code> is the name of
the to-be-created link.</p>
<dl class="docutils">
<dt>Return Value:</dt>
<dd><code class="docutils literal notranslate"><span class="pre">undefined</span></code>.</dd>
</dl>
</div>
<div class="section" id="symlink">
<h3>symlink<a class="headerlink" href="#symlink" title="Permalink to this headline">¬∂</a></h3>
<p>Create a soft (symbolic) link.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">symlink</span><span class="p">({</span><span class="nx">src</span><span class="o">:</span> <span class="nx">sourceName</span><span class="p">,</span> <span class="nx">target</span><span class="o">:</span> <span class="nx">targetName</span><span class="p">});</span>

<span class="cm">/* or */</span>

<span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">symlink</span><span class="p">(</span><span class="nx">sourceName</span><span class="p">,</span> <span class="nx">targetName</span><span class="p">);</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">sourceName</span></code> is the existing file and <code class="docutils literal notranslate"><span class="pre">targetName</span></code> is the name of
the to-be-created symlink.</p>
<dl class="docutils">
<dt>Return Value:</dt>
<dd><code class="docutils literal notranslate"><span class="pre">undefined</span></code>.</dd>
</dl>
</div>
<div class="section" id="chmod">
<h3>chmod<a class="headerlink" href="#chmod" title="Permalink to this headline">¬∂</a></h3>
<p>Change the file mode bits of a file or directory.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">chmod</span><span class="p">(</span><span class="nx">path</span> <span class="p">[,</span> <span class="nx">mode</span><span class="p">]);</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">path</span></code> is a <span class="green">String</span>, the file or directory upon which to be operated
and <code class="docutils literal notranslate"><span class="pre">mode</span></code> is a <span class="green">Number</span> or <span class="green">String</span>, the octal permissions mode.  Any parent
directories which do not exist will also be created.  Throws error if
lacking permissions or if another error was encountered.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">mode</span></code> is normally given as an octal.  As such it can be, e.g.,
<code class="docutils literal notranslate"><span class="pre">0755</span></code> (octal number) or <code class="docutils literal notranslate"><span class="pre">&quot;755&quot;</span></code> (<span class="green">String</span> representation of an octal
number), but <code class="docutils literal notranslate"><span class="pre">755</span></code>, as a decimal number will likely not work as intended.</p>
<dl class="docutils">
<dt>Return Value:</dt>
<dd><code class="docutils literal notranslate"><span class="pre">undefined</span></code>.</dd>
</dl>
</div>
<div class="section" id="realpath">
<h3>realPath<a class="headerlink" href="#realpath" title="Permalink to this headline">¬∂</a></h3>
<p>Find the canonical form of a file system path.  The path or file must exist.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">realPath</span><span class="p">(</span><span class="nx">path</span><span class="p">);</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">path</span></code> is a <span class="green">String</span>, not necessarily in canonical form.</p>
<dl class="docutils">
<dt>Return Value:</dt>
<dd>A <span class="green">String</span>, the canonical form of the path.  Throws an error if path does not exist.</dd>
</dl>
</div>
<div class="section" id="touch">
<h3>touch<a class="headerlink" href="#touch" title="Permalink to this headline">¬∂</a></h3>
<p>Create an empty file, or update the access timestamp of an existing file.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">touch</span><span class="p">(</span><span class="nx">file</span><span class="p">);</span>

<span class="cm">/* or */</span>

<span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">touch</span><span class="p">({</span>
   <span class="nx">path</span><span class="o">:</span> <span class="nx">file</span>
   <span class="p">[,</span> <span class="nx">nocreate</span><span class="o">:</span> <span class="nx">noCreate</span><span class="p">]</span>
   <span class="p">[,</span> <span class="nx">setaccess</span><span class="o">:</span> <span class="nx">setAccess</span><span class="p">]</span>
   <span class="p">[,</span> <span class="nx">setmodify</span><span class="o">:</span> <span class="nx">setModify</span><span class="p">]</span>
   <span class="p">[,</span> <span class="nx">reference</span><span class="o">:</span> <span class="nx">referenceFile</span><span class="p">]</span>
<span class="p">});</span>
</pre></div>
</div>
<p>Where:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">file</span></code> is a <span class="green">String</span>, the name of the file upon which to operate,</li>
<li><code class="docutils literal notranslate"><span class="pre">noCreate</span></code> is a <span class="green">Boolean</span> (default <code class="docutils literal notranslate"><span class="pre">false</span></code>) which, if <code class="docutils literal notranslate"><span class="pre">true</span></code>
will only update the timestamp, and will not create a non-existing
<code class="docutils literal notranslate"><span class="pre">file</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">setAccess</span></code> is a <span class="green">Boolean</span> (default <code class="docutils literal notranslate"><span class="pre">true</span></code>), a <span class="green">Date Object</span>,
or an <span class="green">Number</span> (seconds since unix epoch).  Update access time of
the file to specified date or current date if <code class="docutils literal notranslate"><span class="pre">true</span></code>.  Do not update if
<code class="docutils literal notranslate"><span class="pre">false</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">setModify</span></code> is a <span class="green">Boolean</span> (default <code class="docutils literal notranslate"><span class="pre">true</span></code>), a <span class="green">Date Object</span>,
or an <span class="green">Number</span> (seconds since unix epoch).  Update modification time of
the file to specified date or current date if <code class="docutils literal notranslate"><span class="pre">true</span></code>.  Do not update if
<code class="docutils literal notranslate"><span class="pre">false</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">referenceFile</span></code> is a <span class="green">String</span>.  If specified, the named file‚Äôs access and
modification timestamps will be used rather than the current time/date.</li>
</ul>
<dl class="docutils">
<dt>Return Value:</dt>
<dd><code class="docutils literal notranslate"><span class="pre">undefined</span></code>.</dd>
</dl>
</div>
<div class="section" id="rename">
<h3>rename<a class="headerlink" href="#rename" title="Permalink to this headline">¬∂</a></h3>
<p>Rename or move a file.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">rename</span><span class="p">(</span><span class="nx">source</span><span class="p">,</span> <span class="nx">destination</span><span class="p">);</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">source</span></code> is a <span class="green">String</span>, the file to be renamed or moved, <code class="docutils literal notranslate"><span class="pre">destination</span></code> is a
<span class="green">String</span>, the name of the target file.</p>
<dl class="docutils">
<dt>Return Value:</dt>
<dd><code class="docutils literal notranslate"><span class="pre">undefined</span></code>.</dd>
</dl>
</div>
<div class="section" id="sleep">
<h3>sleep<a class="headerlink" href="#sleep" title="Permalink to this headline">¬∂</a></h3>
<p>Pause execution for specified number of seconds.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">sleep</span><span class="p">(</span><span class="nx">seconds</span><span class="p">);</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">seconds</span></code> is a <span class="green">Number</span>.  Seconds may be a fraction of seconds.
Internally <a class="reference external" href="https://man7.org/linux/man-pages//man2/nanosleep.2.html">nanosleep</a>
is used.</p>
<p>Example:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="cm">/* wait 1.5 seconds */</span>
<span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">sleep</span><span class="p">(</span><span class="mf">1.5</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="gettype">
<h3>getType<a class="headerlink" href="#gettype" title="Permalink to this headline">¬∂</a></h3>
<p>Get the type of variable. A simplified but more specific version of
<code class="docutils literal notranslate"><span class="pre">typeof</span></code>.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">type</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">getType</span><span class="p">(</span><span class="nx">myvar</span><span class="p">);</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Return Value:</dt>
<dd>A <span class="green">String</span>, one of <code class="docutils literal notranslate"><span class="pre">String</span></code>, <code class="docutils literal notranslate"><span class="pre">Array</span></code>, <code class="docutils literal notranslate"><span class="pre">Number</span></code>, <code class="docutils literal notranslate"><span class="pre">Function</span></code>,
<code class="docutils literal notranslate"><span class="pre">Boolean</span></code>, <code class="docutils literal notranslate"><span class="pre">Buffer</span></code> (any buffer type), <code class="docutils literal notranslate"><span class="pre">Nan</span></code>, <code class="docutils literal notranslate"><span class="pre">Null</span></code>,
<code class="docutils literal notranslate"><span class="pre">Undefined</span></code>, <code class="docutils literal notranslate"><span class="pre">Date</span></code> or <code class="docutils literal notranslate"><span class="pre">Object</span></code> (excluding any of the other types of
<span class="green">Objects</span> such as <code class="docutils literal notranslate"><span class="pre">Null</span></code>, <code class="docutils literal notranslate"><span class="pre">Array</span></code> or <code class="docutils literal notranslate"><span class="pre">Function</span></code>) .</dd>
</dl>
</div>
<div class="section" id="timezone">
<h3>timezone<a class="headerlink" href="#timezone" title="Permalink to this headline">¬∂</a></h3>
<p>Retrieve system timezone information.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">tz</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">timezone</span><span class="p">([</span><span class="nx">directory</span><span class="p">]);</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">directory</span></code> is an optional directory with timezone information.  Default
is <code class="docutils literal notranslate"><span class="pre">&quot;/usr/share/zoneinfo&quot;</span></code>.</p>
<dl class="docutils">
<dt>Return Value:</dt>
<dd>An <span class="green">Object</span> with the following functions: <code class="docutils literal notranslate"><span class="pre">findZone()</span></code>, <code class="docutils literal notranslate"><span class="pre">findAbbr()</span></code> and <code class="docutils literal notranslate"><span class="pre">dump()</span></code>.</dd>
</dl>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">tz.findZone(tzname)</span></code> - Return an <span class="green">Object</span> with timezone information.  If the timezone
does not exist, returns <code class="docutils literal notranslate"><span class="pre">undefined</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">tz.findAbbr(abbrname)</span></code> - Return an <span class="green">Object</span> with a list of timezones that match the given
abbreviation.  If the abbreviation does not exist, returns <code class="docutils literal notranslate"><span class="pre">undefined</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">tz.dump()</span></code> - Return an <span class="green">Object</span> with the entire database organized by timezones and
abbreviations.</li>
</ul>
<p>Example:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">tz</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">timezone</span><span class="p">();</span>

<span class="kd">var</span> <span class="nx">pstZones</span> <span class="o">=</span> <span class="nx">tz</span><span class="p">.</span><span class="nx">findAbbr</span><span class="p">(</span><span class="s2">&quot;PST&quot;</span><span class="p">);</span>
<span class="cm">/*  ambiguous     =&gt; whether there are zones in &quot;entries&quot; with differing offsets</span>
<span class="cm">    zoneAbbrIndex =&gt; where in the &quot;abbreviations&quot; section of the zone info</span>
<span class="cm">                     below &quot;PST&quot; is found</span>
<span class="cm">{</span>
<span class="cm">   &quot;ambiguous&quot;: true,</span>
<span class="cm">   &quot;entries&quot;: [</span>
<span class="cm">      {</span>
<span class="cm">         &quot;offset&quot;: -28800,</span>
<span class="cm">         &quot;offsetString&quot;: &quot;-8:00&quot;,</span>
<span class="cm">         &quot;zoneName&quot;: &quot;America/Bahia_Banderas&quot;,</span>
<span class="cm">         &quot;zoneAbbrIndex&quot;: 5</span>
<span class="cm">      },</span>
<span class="cm">      {</span>
<span class="cm">         &quot;offset&quot;: -28800,</span>
<span class="cm">         &quot;offsetString&quot;: &quot;-8:00&quot;,</span>
<span class="cm">         &quot;zoneName&quot;: &quot;America/Boise&quot;,</span>
<span class="cm">         &quot;zoneAbbrIndex&quot;: 2</span>
<span class="cm">      },</span>
<span class="cm">      ...</span>
<span class="cm">   ]</span>
<span class="cm">}</span>
<span class="cm">*/</span>

<span class="kd">var</span> <span class="nx">LAZone</span> <span class="o">=</span> <span class="nx">tz</span><span class="p">.</span><span class="nx">findZone</span><span class="p">(</span><span class="s2">&quot;America/Los_Angeles&quot;</span><span class="p">);</span>
<span class="cm">/*</span>
<span class="cm">{</span>
<span class="cm">   &quot;name&quot;: &quot;America/Los_Angeles&quot;,</span>
<span class="cm">   &quot;abbreviations&quot;: [</span>
<span class="cm">      {</span>
<span class="cm">         &quot;Abbreviation&quot;: &quot;LMT&quot;,</span>
<span class="cm">         &quot;UTCOffset&quot;: -28378,</span>
<span class="cm">         &quot;isDST&quot;: false</span>
<span class="cm">      },</span>
<span class="cm">      {</span>
<span class="cm">         &quot;Abbreviation&quot;: &quot;PDT&quot;,</span>
<span class="cm">         &quot;UTCOffset&quot;: -25200,</span>
<span class="cm">         &quot;isDST&quot;: true</span>
<span class="cm">      },</span>
<span class="cm">      {</span>
<span class="cm">         &quot;Abbreviation&quot;: &quot;PST&quot;,</span>
<span class="cm">         &quot;UTCOffset&quot;: -28800,</span>
<span class="cm">         &quot;isDST&quot;: false</span>
<span class="cm">      },</span>
<span class="cm">      {</span>
<span class="cm">         &quot;Abbreviation&quot;: &quot;PWT&quot;,</span>
<span class="cm">         &quot;UTCOffset&quot;: -25200,</span>
<span class="cm">         &quot;isDST&quot;: true</span>
<span class="cm">      },</span>
<span class="cm">      {</span>
<span class="cm">         &quot;Abbreviation&quot;: &quot;PPT&quot;,</span>
<span class="cm">         &quot;UTCOffset&quot;: -25200,</span>
<span class="cm">         &quot;isDST&quot;: true</span>
<span class="cm">      },</span>
<span class="cm">      {</span>
<span class="cm">         &quot;Abbreviation&quot;: &quot;PST&quot;,</span>
<span class="cm">         &quot;UTCOffset&quot;: -28800,</span>
<span class="cm">         &quot;isDST&quot;: false</span>
<span class="cm">      }</span>
<span class="cm">   ],</span>
<span class="cm">   &quot;transitions&quot;: [</span>
<span class="cm">      {</span>
<span class="cm">         &quot;transitionDate&quot;: &quot;1901-12-13T20:45:52.000Z&quot;,</span>
<span class="cm">         &quot;transition&quot;: {</span>
<span class="cm">            &quot;Abbreviation&quot;: &quot;PST&quot;,</span>
<span class="cm">            &quot;UTCOffset&quot;: -28800,</span>
<span class="cm">            &quot;isDST&quot;: false</span>
<span class="cm">         }</span>
<span class="cm">      },</span>
<span class="cm">      {</span>
<span class="cm">         &quot;transitionDate&quot;: &quot;1918-03-31T10:00:00.000Z&quot;,</span>
<span class="cm">         &quot;transition&quot;: {</span>
<span class="cm">            &quot;Abbreviation&quot;: &quot;PDT&quot;,</span>
<span class="cm">            &quot;UTCOffset&quot;: -25200,</span>
<span class="cm">            &quot;isDST&quot;: true</span>
<span class="cm">         }</span>
<span class="cm">      },</span>
<span class="cm">      ...</span>
<span class="cm">   ]</span>
<span class="cm">}</span>
<span class="cm">*/</span>
</pre></div>
</div>
</div>
<div class="section" id="datefmt">
<h3>dateFmt<a class="headerlink" href="#datefmt" title="Permalink to this headline">¬∂</a></h3>
<p>Format a date <span class="green">String</span>.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">datestr</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">dateFmt</span><span class="p">(</span><span class="nx">format</span><span class="p">[,</span> <span class="nx">date</span><span class="p">][,</span> <span class="nx">input_format</span><span class="p">])</span>
</pre></div>
</div>
<p>Where:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">format</span></code> is a <a class="reference external" href="https://linux.die.net/man/3/strftime">strftime</a> style format
<span class="green">String</span>.</li>
<li><code class="docutils literal notranslate"><span class="pre">date</span></code> is an optional date as a <span class="green">String</span>, <span class="green">Number</span> (seconds since 1970-01-01),
or a <span class="green">Date</span>.  The default value is the current time.</li>
<li><code class="docutils literal notranslate"><span class="pre">input_format</span></code> is an optional format if <code class="docutils literal notranslate"><span class="pre">date</span></code> is a <span class="green">String</span>, in the style of
<a class="reference external" href="https://linux.die.net/man/3/strptime">strptime</a>.  The default is to try the following in order:</li>
</ul>
</div></blockquote>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;%Y-%m-%d %H:%M:%S %z&quot;</span>
<span class="s2">&quot;%A %B %d %H:%M:%S %Y %z&quot;</span>
<span class="s2">&quot;%Y-%m-%d %H:%M:%S&quot;</span>
<span class="s2">&quot;%A %B %d %H:%M:%S %Y&quot;</span>
<span class="s2">&quot;%Y-%m-%dT%H:%M:%S&quot;</span>
<span class="s2">&quot;%c&quot;</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Return Value:</dt>
<dd>The formatted date as a <span class="green">String</span>.</dd>
</dl>
<p>Note:</p>
<blockquote>
<div><ul class="simple">
<li>Millisecond notation in the string in the form of <code class="docutils literal notranslate"><span class="pre">.123</span></code> or <code class="docutils literal notranslate"><span class="pre">.123Z</span></code> is disregarded.</li>
<li>The return <span class="green">String</span> is a date in local time.</li>
<li>If year or year/month/day formats are missing, the current year or date respectively is assumed.</li>
<li>If the <code class="docutils literal notranslate"><span class="pre">%z</span></code> format is specified in the <code class="docutils literal notranslate"><span class="pre">input_format</span></code> <span class="green">String</span>,
the date will be converted from that timezone offset to local time.</li>
<li>The <code class="docutils literal notranslate"><span class="pre">%Z</span></code> format has no effect on the time zone.</li>
</ul>
</div></blockquote>
<p>Example:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">rampart</span><span class="p">.</span><span class="nx">globalize</span><span class="p">(</span><span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">d</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>

<span class="nx">printf</span><span class="p">(</span> <span class="s2">&quot;%s\n%s\n%s\n%s\n%s\n%s\n%s\n%s\n&quot;</span><span class="p">,</span>
    <span class="nx">dateFmt</span><span class="p">(</span><span class="s2">&quot;%c&quot;</span><span class="p">,</span> <span class="s2">&quot;Mon Jul 26 12:00:01 2021&quot;</span><span class="p">),</span>
    <span class="nx">dateFmt</span><span class="p">(</span><span class="s2">&quot;%c&quot;</span><span class="p">,</span> <span class="s2">&quot;Mon Jul 26 12:00:01 2021 -04:00&quot;</span><span class="p">),</span>
    <span class="nx">dateFmt</span><span class="p">(</span><span class="s2">&quot;%c&quot;</span><span class="p">,</span> <span class="s2">&quot;1999-12-31 23:59:59 -0000&quot;</span><span class="p">),</span>
    <span class="nx">dateFmt</span><span class="p">(</span><span class="s2">&quot;%c&quot;</span><span class="p">,</span> <span class="s2">&quot;2020&quot;</span><span class="p">,</span> <span class="s2">&quot;%Y&quot;</span><span class="p">),</span>
    <span class="nx">dateFmt</span><span class="p">(</span><span class="s2">&quot;%c&quot;</span><span class="p">,</span> <span class="nx">d</span><span class="p">),</span>
    <span class="nx">dateFmt</span><span class="p">(</span><span class="s2">&quot;%Y-%m-%d&quot;</span><span class="p">),</span>
    <span class="nx">dateFmt</span><span class="p">(</span><span class="s2">&quot;%m/%d/%Y %H:%M:%S %Z&quot;</span><span class="p">,</span> <span class="mi">946713599</span><span class="p">),</span>
    <span class="nx">dateFmt</span><span class="p">(</span><span class="s2">&quot;Today&#39;s lunch:  %c&quot;</span><span class="p">,</span> <span class="s2">&quot;12:15&quot;</span><span class="p">,</span> <span class="s1">&#39;%H:%M&#39;</span><span class="p">)</span>
<span class="p">);</span>

<span class="cm">/* Expected output:</span>
<span class="cm">Mon Jul 26 12:00:01 2021</span>
<span class="cm">Mon Jul 26 09:00:01 2021</span>
<span class="cm">Fri Dec 31 15:59:59 1999</span>
<span class="cm">Wed Jan  1 00:00:00 2020</span>
<span class="cm">Tue Jul 27 01:06:57 2021</span>
<span class="cm">2021-07-27</span>
<span class="cm">12/31/1999 23:59:59 PST</span>
<span class="cm">Today&#39;s lunch:  Tue Jul 27 12:15:00 2021</span>
<span class="cm">*/</span>
</pre></div>
</div>
</div>
<div class="section" id="scandate">
<h3>scanDate<a class="headerlink" href="#scandate" title="Permalink to this headline">¬∂</a></h3>
<p>Scan a date <span class="green">String</span> and return a JavaScript date.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">mydate</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">scanDate</span><span class="p">(</span><span class="nx">dateString</span><span class="p">[,</span> <span class="nx">default_offset</span><span class="p">][,</span> <span class="nx">input_format</span><span class="p">]);</span>
</pre></div>
</div>
<p>Where:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">dateString</span></code> is the same as <code class="docutils literal notranslate"><span class="pre">date</span></code> (as a <span class="green">String</span>) in <a class="reference internal" href="#datefmt">dateFmt</a> above.</li>
<li><code class="docutils literal notranslate"><span class="pre">default_offset</span></code> is the time zone offset in seconds to use if not provided in <code class="docutils literal notranslate"><span class="pre">dateString</span></code>.
The default is <code class="docutils literal notranslate"><span class="pre">0</span></code> (UTC).</li>
<li><code class="docutils literal notranslate"><span class="pre">input_format</span></code> is the same as in <a class="reference internal" href="#datefmt">dateFmt</a> above.</li>
</ul>
</div></blockquote>
<dl class="docutils">
<dt>Return Value:</dt>
<dd>A JavaScript <span class="green">Date</span>.</dd>
</dl>
</div>
<div class="section" id="autoscandate">
<h3>autoScanDate<a class="headerlink" href="#autoscandate" title="Permalink to this headline">¬∂</a></h3>
<p>Attempt to match a date from a <span class="green">String</span> using various formats.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">dateRes</span> <span class="o">=</span> <span class="nx">autoScanDate</span><span class="p">(</span><span class="nx">dateString</span><span class="p">);</span>
</pre></div>
</div>
<p>Return Value: An <span class="green">Object</span>.</p>
<blockquote>
<div><p>If no timezone offset or abbreviation is present, the return object has
the following properties:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">date</span></code>          - a JavaScript <span class="green">Date</span>.</li>
<li><code class="docutils literal notranslate"><span class="pre">offset</span></code>        - timezone offset (in this case <code class="docutils literal notranslate"><span class="pre">0</span></code> for GMT).</li>
<li><code class="docutils literal notranslate"><span class="pre">endIndex</span></code>      - last character position in <code class="docutils literal notranslate"><span class="pre">dateString</span></code> of the match.</li>
<li><code class="docutils literal notranslate"><span class="pre">matchedFormat</span></code> - the format that was successfully matched.</li>
</ul>
<p>If a timezone offset is present, offset will be set to that timezone and
and GMT will be returned with the offset set.</p>
<p>If a timezone abbreviation is present and valid, offset will be set to
the best matching timezone (as sorted by distance from the system timezone).
Also present is <code class="docutils literal notranslate"><span class="pre">dates</span></code> for all the possible timezones which match the
abbreviation, filtered by the validity of the Abbreviation (i.e. PST vs PDT)
on the given date.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">dateString</span></code> could not be parsed, <code class="docutils literal notranslate"><span class="pre">Null</span></code> is returned.</p>
</div></blockquote>
<p>Example:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">dateRes</span> <span class="o">=</span> <span class="nx">autoScanDate</span><span class="p">(</span><span class="s2">&quot;Jan 5 03:20 pm 2002&quot;</span><span class="p">);</span>
<span class="cm">/*</span>
<span class="cm">{</span>
<span class="cm">   &quot;date&quot;: &quot;2002-01-05T15:20:00.000Z&quot;,</span>
<span class="cm">   &quot;offset&quot;: 0,</span>
<span class="cm">   &quot;endIndex&quot;: 19,</span>
<span class="cm">   &quot;matchedFormat&quot;: &quot;%b %e %I:%M %p %Y&quot;</span>
<span class="cm">}</span>
<span class="cm">*/</span>

<span class="nx">dateRes</span><span class="o">=</span><span class="nx">autoScanDate</span><span class="p">(</span><span class="s2">&quot;Jan 5 03:20 pm 2002 -0800&quot;</span><span class="p">);</span>
<span class="cm">/*</span>
<span class="cm">{</span>
<span class="cm">   &quot;date&quot;: &quot;2002-01-05T23:20:00.000Z&quot;,</span>
<span class="cm">   &quot;offset&quot;: -28800,</span>
<span class="cm">   &quot;endIndex&quot;: 25,</span>
<span class="cm">   &quot;matchedFormat&quot;: &quot;%b %e %I:%M %p %Y %z&quot;</span>
<span class="cm">}</span>
<span class="cm">*/</span>

<span class="nx">dateRes</span><span class="o">=</span><span class="nx">autoScanDate</span><span class="p">(</span><span class="s2">&quot;Jan 5 03:20 pm 2002 PST&quot;</span><span class="p">);</span>
<span class="cm">/* &quot;dates&quot; is sorted by distance from current timezone offset</span>
<span class="cm">   &quot;ambiguous&quot; is true because Manila has a timezone abbv &quot;PST&quot;</span>
<span class="cm">   &quot;date&quot; is set to the first record in &quot;dates&quot;</span>
<span class="cm">{</span>
<span class="cm">   &quot;ambiguous&quot;: true,</span>
<span class="cm">   &quot;dates&quot;: {</span>
<span class="cm">      &quot;America/Dawson&quot;: &quot;2002-01-05T23:20:00.000Z&quot;,</span>
<span class="cm">      &quot;America/Fort_Nelson&quot;: &quot;2002-01-05T23:20:00.000Z&quot;,</span>
<span class="cm">      &quot;America/Metlakatla&quot;: &quot;2002-01-05T23:20:00.000Z&quot;,</span>
<span class="cm">      &quot;America/Ensenada&quot;: &quot;2002-01-05T23:20:00.000Z&quot;,</span>
<span class="cm">      &quot;America/Santa_Isabel&quot;: &quot;2002-01-05T23:20:00.000Z&quot;,</span>
<span class="cm">      &quot;America/Tijuana&quot;: &quot;2002-01-05T23:20:00.000Z&quot;,</span>
<span class="cm">      &quot;America/Los_Angeles&quot;: &quot;2002-01-05T23:20:00.000Z&quot;,</span>
<span class="cm">      ...</span>
<span class="cm">      &quot;Asia/Manila&quot;: &quot;2002-01-05T07:20:00.000Z&quot;,</span>
<span class="cm">      &quot;posix/Asia/Manila&quot;: &quot;2002-01-05T07:20:00.000Z&quot;,</span>
<span class="cm">      &quot;right/Asia/Manila&quot;: &quot;2002-01-05T07:20:00.000Z&quot;</span>
<span class="cm">   },</span>
<span class="cm">   &quot;date&quot;: &quot;2002-01-05T23:20:00.000Z&quot;,</span>
<span class="cm">   &quot;offset&quot;: -28800,</span>
<span class="cm">   &quot;endIndex&quot;: 23,</span>
<span class="cm">   &quot;matchedFormat&quot;: &quot;%b %e %I:%M %p %Y %Z&quot;</span>
<span class="cm">}</span>
<span class="cm">*/</span>

<span class="nx">dateRes</span><span class="o">=</span><span class="nx">autoScanDate</span><span class="p">(</span><span class="s2">&quot;Aug 5 03:20 pm 2002 PST&quot;</span><span class="p">);</span>
<span class="cm">/* note that most timezones that would match PST are observing</span>
<span class="cm">   PDT in August, so they are excluded.</span>
<span class="cm">{</span>
<span class="cm">   &quot;ambiguous&quot;: true,</span>
<span class="cm">   &quot;dates&quot;: {</span>
<span class="cm">      &quot;America/Metlakatla&quot;: &quot;2002-08-05T23:20:00.000Z&quot;,</span>
<span class="cm">      &quot;posix/America/Metlakatla&quot;: &quot;2002-08-05T23:20:00.000Z&quot;,</span>
<span class="cm">      &quot;right/America/Metlakatla&quot;: &quot;2002-08-05T23:20:00.000Z&quot;,</span>
<span class="cm">      &quot;Asia/Manila&quot;: &quot;2002-08-05T07:20:00.000Z&quot;,</span>
<span class="cm">      &quot;posix/Asia/Manila&quot;: &quot;2002-08-05T07:20:00.000Z&quot;,</span>
<span class="cm">      &quot;right/Asia/Manila&quot;: &quot;2002-08-05T07:20:00.000Z&quot;</span>
<span class="cm">   },</span>
<span class="cm">   &quot;date&quot;: &quot;2002-08-05T23:20:00.000Z&quot;,</span>
<span class="cm">   &quot;offset&quot;: -28800,</span>
<span class="cm">   &quot;endIndex&quot;: 23,</span>
<span class="cm">   &quot;matchedFormat&quot;: &quot;%b %e %I:%M %p %Y %Z&quot;</span>
<span class="cm">}</span>
<span class="cm">*/</span>
</pre></div>
</div>
</div>
<div class="section" id="use">
<h3>use<a class="headerlink" href="#use" title="Permalink to this headline">¬∂</a></h3>
<p>Shortcut and alternative for importing modules with <a class="reference internal" href="rampart-main.html#using-the-require-function-to-import-modules"><span class="std std-ref">require</span></a>.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">rampart</span><span class="p">.</span><span class="nx">globalize</span><span class="p">(</span><span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">);</span><span class="c1">//put utils in the global namespace</span>

<span class="kd">var</span> <span class="nx">Sql</span> <span class="o">=</span> <span class="nx">use</span><span class="p">.</span><span class="nx">sql</span><span class="p">;</span> <span class="c1">//same as var Sql = require(&quot;rampart-sql&quot;);</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">use</span></code> <span class="green">Object</span> is a proxy object which uses the property name referenced (here <code class="docutils literal notranslate"><span class="pre">&quot;sql</span></code>) and searches for
a module named <code class="docutils literal notranslate"><span class="pre">&quot;rampart-sql&quot;</span></code>.  Failing that it will search for a module named (<code class="docutils literal notranslate"><span class="pre">&quot;sql&quot;</span></code>).  It will then call
the <a class="reference internal" href="rampart-main.html#using-the-require-function-to-import-modules"><span class="std std-ref">require</span></a> function to import and return that value.
If no module can be found, it will throw an error.</p>
<dl class="docutils">
<dt>Return Value:</dt>
<dd>The exported module.</dd>
</dl>
</div>
<div class="section" id="load">
<h3>load<a class="headerlink" href="#load" title="Permalink to this headline">¬∂</a></h3>
<p>Same as <a class="reference internal" href="#use">use</a> above except that the property name is also put in the global namespace.</p>
<p>Example:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">rampart</span><span class="p">.</span><span class="nx">globalize</span><span class="p">(</span><span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">);</span><span class="c1">//put utils in the global namespace</span>

<span class="nx">load</span><span class="p">.</span><span class="nx">curl</span><span class="p">;</span>  <span class="c1">//same as global.curl = require(&quot;rampart-curl&quot;);</span>

<span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="nx">curl</span><span class="p">.</span><span class="nx">fetch</span><span class="p">(</span><span class="s2">&quot;http...&quot;</span><span class="p">);</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Note:</dt>
<dd>The file name of the module must be lowercase, while the variable name may be
mixed case.  Example: <code class="docutils literal notranslate"><span class="pre">load.Sql;</span></code> is equivalent to
<code class="docutils literal notranslate"><span class="pre">global.Sql=require(&quot;rampart-sql&quot;);</span></code>.</dd>
<dt>Caveat:</dt>
<dd>This cannot be used to load a module whose name contains illegal JavaScript variable name characters. Thus,
<code class="docutils literal notranslate"><span class="pre">load[&quot;my&#64;mod&quot;]</span></code> will not work since <code class="docutils literal notranslate"><span class="pre">'&#64;'</span></code> is not legal in javaScript even though it is legal in a file name.
However <code class="docutils literal notranslate"><span class="pre">'-'</span></code> and <code class="docutils literal notranslate"><span class="pre">'.'</span></code> characters will be replaced with <code class="docutils literal notranslate"><span class="pre">'_'</span></code>.  Thus, <code class="docutils literal notranslate"><span class="pre">load[&quot;rampart-curl.so&quot;]</span></code> will
load the Curl Module and put it in the global namespace similar to <code class="docutils literal notranslate"><span class="pre">var</span> <span class="pre">rampart_curl_so</span> <span class="pre">=</span> <span class="pre">require(&quot;rampart-curl.so&quot;)</span></code>.</dd>
</dl>
</div>
<div class="section" id="errorconfig">
<h3>errorConfig<a class="headerlink" href="#errorconfig" title="Permalink to this headline">¬∂</a></h3>
<p>Configure the format of reported errors.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">errorConfig</span><span class="p">(</span><span class="nx">options</span><span class="p">);</span>

<span class="cm">/* or */</span>

<span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">errorConfig</span><span class="p">(</span><span class="nx">simple</span><span class="p">,</span> <span class="nx">lines</span><span class="p">);</span>
</pre></div>
</div>
<p>Where:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">options</span></code> is an <span class="green">Object</span> with the properties <code class="docutils literal notranslate"><span class="pre">simple</span></code> and
<code class="docutils literal notranslate"><span class="pre">lines</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">simple</span></code> is a <span class="green">Boolean</span> (default <code class="docutils literal notranslate"><span class="pre">false</span></code>) - whether to reduce
the verbosity of the stack trace.</li>
<li><code class="docutils literal notranslate"><span class="pre">lines</span></code> is a <span class="green">Number</span> (default <code class="docutils literal notranslate"><span class="pre">0</span></code>) - the number of lines of
the source code surrounding the error to print.  If greater than <code class="docutils literal notranslate"><span class="pre">0</span></code> and
an even number, it will be incremented up to the next odd number.</li>
</ul>
<p>Examples:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="cm">/* default settings */</span>
<span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">errorConfig</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>

<span class="kd">function</span> <span class="nx">myfunc</span><span class="p">(</span><span class="nx">myvar</span><span class="p">)</span> <span class="p">{</span>
   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">myvar</span><span class="p">.</span><span class="nx">x</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">myfunc</span><span class="p">();</span>

<span class="cm">/* expected output</span>
<span class="cm">   TypeError: cannot read property &#39;x&#39; of undefined</span>
<span class="cm">       at [anon] (/usr/local/src/rampart/src/duktape/core/duktape.c:60539) internal</span>
<span class="cm">       at myfunc (myscript.js:4)</span>
<span class="cm">       at global (myscript.js:7) preventsyield</span>
<span class="cm">*/</span>
</pre></div>
</div>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="cm">/* simple stack */</span>
<span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">errorConfig</span><span class="p">({</span><span class="nx">simple</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">lines</span><span class="o">:</span><span class="mi">0</span><span class="p">});</span>

<span class="kd">function</span> <span class="nx">myfunc</span><span class="p">(</span><span class="nx">myvar</span><span class="p">)</span> <span class="p">{</span>
   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">myvar</span><span class="p">.</span><span class="nx">x</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">myfunc</span><span class="p">();</span>

<span class="cm">/* expected output</span>
<span class="cm">   TypeError: cannot read property &#39;x&#39; of undefined</span>
<span class="cm">       at myfunc (myscript.js:4)</span>
<span class="cm">       at global (myscript.js:7)</span>
<span class="cm">*/</span>
</pre></div>
</div>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="cm">/* simple stack and 3 lines */</span>
<span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">errorConfig</span><span class="p">({</span><span class="nx">simple</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">lines</span><span class="o">:</span><span class="mi">3</span><span class="p">});</span>

<span class="kd">function</span> <span class="nx">myfunc</span><span class="p">(</span><span class="nx">myvar</span><span class="p">)</span> <span class="p">{</span>
   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">myvar</span><span class="p">.</span><span class="nx">x</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">myfunc</span><span class="p">();</span>

<span class="cm">/* expected output</span>
<span class="cm">   TypeError: cannot read property &#39;x&#39; of undefined</span>
<span class="cm">       at myfunc (myscript.js:4)</span>
<span class="cm">       at global (myscript.js:7)</span>

<span class="cm">   File: myscript.js</span>
<span class="cm">   line 3:    |function myfunc(myvar) {</span>
<span class="cm">   line 4: -&gt; |    console.log(myvar.x);</span>
<span class="cm">   line 5:    |}</span>
<span class="cm">*/</span>
</pre></div>
</div>
</div>
<div class="section" id="deepcopy">
<h3>deepCopy<a class="headerlink" href="#deepcopy" title="Permalink to this headline">¬∂</a></h3>
<p>Make a deep copy of one or more <span class="green">Objects</span>.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">target</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">deepCopy</span><span class="p">([</span><span class="nx">appendArrays</span> <span class="p">[,</span> <span class="nx">copyBuffers</span><span class="p">]],</span> <span class="nx">target</span><span class="p">,</span> <span class="nx">obj1</span><span class="p">[,</span> <span class="nx">obj2</span><span class="p">,</span> <span class="nx">obj3</span><span class="p">,</span> <span class="p">...]);</span>
</pre></div>
</div>
<p>Where:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">appendArrays</span></code> - a <span class="green">Boolean</span>, whether to append an <span class="green">Array</span> with the same key
instead of replace it with the source <span class="green">Array</span>.  Default is <code class="docutils literal notranslate"><span class="pre">false</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">copyBuffers</span></code> - a <span class="green">Boolean</span>, whether to copy the full binary contents of a <span class="green">Buffer</span>
rather than its reference.  Default is <code class="docutils literal notranslate"><span class="pre">true</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">target</span></code> - an <span class="green">Object</span> into which the subsequent <span class="green">Object</span> parameters will be copied.</li>
<li><code class="docutils literal notranslate"><span class="pre">objn</span></code>- Source <span class="green">Objects</span> to copy from, with later <span class="green">Objects</span> overwriting duplicate keys in earlier ones.</li>
</ul>
</div></blockquote>
<p>Example:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">target</span><span class="p">,</span>
    <span class="nx">source1</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">account</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">firstName</span><span class="o">:</span> <span class="s2">&quot;John&quot;</span>
        <span class="p">},</span>
        <span class="nx">links</span><span class="o">:</span> <span class="p">[</span>
            <span class="s1">&#39;http://example.com/jsmith1.html&#39;</span>
        <span class="p">]</span>
    <span class="p">},</span>
    <span class="nx">source2</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">account</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">lastName</span><span class="o">:</span> <span class="s2">&quot;Smith&quot;</span>
        <span class="p">},</span>
        <span class="nx">links</span><span class="o">:</span> <span class="p">[</span>
            <span class="s1">&#39;http://example.com/jsmith_about.html&#39;</span>
        <span class="p">]</span>
    <span class="p">};</span>

<span class="nx">target</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">deepCopy</span><span class="p">({},</span> <span class="nx">source1</span><span class="p">,</span> <span class="nx">source2</span><span class="p">);</span>
<span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">printf</span><span class="p">(</span><span class="s2">&quot;%3J\n&quot;</span><span class="p">,</span> <span class="nx">target</span><span class="p">);</span>
<span class="cm">/* expected output:</span>
<span class="cm">    {</span>
<span class="cm">       &quot;account&quot;: {</span>
<span class="cm">          &quot;firstName&quot;: &quot;John&quot;,</span>
<span class="cm">          &quot;lastName&quot;: &quot;Smith&quot;</span>
<span class="cm">       },</span>
<span class="cm">       &quot;links&quot;: [</span>
<span class="cm">          &quot;http://example.com/jsmith_about.html&quot;</span>
<span class="cm">       ]</span>
<span class="cm">    }</span>
<span class="cm">*/</span>

<span class="c1">// true == append the &quot;links&quot; array</span>
<span class="nx">target</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">deepCopy</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="p">{},</span> <span class="nx">source1</span><span class="p">,</span> <span class="nx">source2</span><span class="p">);</span>
<span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">printf</span><span class="p">(</span><span class="s2">&quot;%3J\n&quot;</span><span class="p">,</span> <span class="nx">target</span><span class="p">);</span>
<span class="cm">/* expected output:</span>
<span class="cm">    {</span>
<span class="cm">       &quot;account&quot;: {</span>
<span class="cm">          &quot;firstName&quot;: &quot;John&quot;,</span>
<span class="cm">          &quot;lastName&quot;: &quot;Smith&quot;</span>
<span class="cm">       },</span>
<span class="cm">       &quot;links&quot;: [</span>
<span class="cm">          &quot;http://example.com/jsmith1.html&quot;,</span>
<span class="cm">          &quot;http://example.com/jsmith_about.html&quot;</span>
<span class="cm">       ]</span>
<span class="cm">    }</span>
<span class="cm">*/</span>
</pre></div>
</div>
</div>
<div class="section" id="eventcallback">
<h3>eventCallback<a class="headerlink" href="#eventcallback" title="Permalink to this headline">¬∂</a></h3>
<p>Register a callback <span class="green">Function</span> to catch warnings or errors produced by Rampart‚Äôs event loop (libevent2).</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">eventCallback</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">level</span><span class="p">,</span><span class="nx">msg</span><span class="p">){</span> <span class="cm">/* handle or report here */</span> <span class="p">});</span>
</pre></div>
</div>
<p>Where:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">level</span></code> - a <span class="green">String</span>, one of <code class="docutils literal notranslate"><span class="pre">&quot;msg&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;warn&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;error&quot;</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">msg</span></code> - a <span class="green">String</span>, the message from libevent2.</li>
</ul>
</div></blockquote>
<dl class="docutils">
<dt>Note:</dt>
<dd>In normal usage, this function should not be necessary.  If used, the callback function must
not call any asychronous functions.  See <a class="reference external" href="https://libevent.org/libevent-book/Ref1_libsetup.html">the libevent2 reference</a>
for more information.</dd>
</dl>
</div>
</div>
<div class="section" id="file-handle-utilities">
<h2>File Handle Utilities<a class="headerlink" href="#file-handle-utilities" title="Permalink to this headline">¬∂</a></h2>
<p>The functions <a class="reference internal" href="#fprintf">fprintf</a> (), <a class="reference internal" href="#fseek">fseek</a>(), <a class="reference internal" href="#rewind">rewind</a>(), <a class="reference internal" href="#ftell">ftell</a>(), <a class="reference internal" href="#fflush">fflush</a>(),
<a class="reference internal" href="#fread">fread</a>(), <a class="reference internal" href="#fgets">fgets</a>(), <a class="reference internal" href="#fwrite">fwrite</a>(), and <a class="reference internal" href="#readline">readLine</a>() take a filehandle, which may be obtained
using <a class="reference internal" href="#fopen">fopen</a>() or <a class="reference internal" href="#fopenbuffer">fopenBuffer</a>().</p>
<dl class="docutils">
<dt>Calling Methods:</dt>
<dd><p class="first">The above listed functions (functions which take filehandles) may be called using one of
two alternative syntaxes.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">handle</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">fopen</span><span class="p">(</span><span class="nx">filename</span><span class="p">,</span> <span class="nx">mode</span><span class="p">);</span>

<span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">fprintf</span><span class="p">(</span><span class="nx">handle</span><span class="p">,</span> <span class="nx">fmt</span><span class="p">,</span> <span class="p">...);</span>

<span class="cm">/* or */</span>

<span class="nx">handle</span><span class="p">.</span><span class="nx">fprintf</span><span class="p">(</span><span class="nx">fmt</span><span class="p">,</span> <span class="p">...);</span>
</pre></div>
</div>
<p>The return value for each of the file handle functions is the same for either
syntax, with the exception that <a class="reference internal" href="#fseek">fseek</a>(), <a class="reference internal" href="#rewind">rewind</a>() and <a class="reference internal" href="#fflush">fflush</a>()
return undefined in the first syntax and <code class="docutils literal notranslate"><span class="pre">handle</span></code> in the second.</p>
<p class="last">Below, only the first syntax is documented.</p>
</dd>
<dt>Pre-opened file handles:</dt>
<dd><dl class="first docutils">
<dt>rampart.utils.stdin:</dt>
<dd>A handle that corresponds to the UNIX standard in stream.</dd>
<dt>rampart.utils.stdout:</dt>
<dd>A handle that corresponds to the UNIX standard out stream.</dd>
<dt>rampart.utils.stderr:</dt>
<dd>A handle that corresponds to the Unix standard error stream.</dd>
<dt>rampart.utils.accessLog:</dt>
<dd>A handle that corresponds to the <code class="docutils literal notranslate"><span class="pre">accessLog</span></code> file option in <code class="docutils literal notranslate"><span class="pre">server.start()</span></code> for the
<code class="docutils literal notranslate"><span class="pre">rampart-server</span></code> module.  If not specified, or not loaded, same as
<code class="docutils literal notranslate"><span class="pre">rampart.utils.stdout</span></code>.</dd>
<dt>rampart.utils.errorLog:</dt>
<dd>A handle that corresponds to the <code class="docutils literal notranslate"><span class="pre">errorLog</span></code> file option in <code class="docutils literal notranslate"><span class="pre">server.start()</span></code> for the
<code class="docutils literal notranslate"><span class="pre">rampart-server</span></code> module.  If not specified, or not loaded, same as
<code class="docutils literal notranslate"><span class="pre">rampart.utils.stderr</span></code>.</dd>
</dl>
<p>The <code class="docutils literal notranslate"><span class="pre">rampart.utils.stdin</span></code> handle includes in its properties the <a class="reference internal" href="#fread">fread</a>(), <a class="reference internal" href="#fgets">fgets</a>() and <a class="reference internal" href="#readline">readLine</a>() functions
while the other four include the <a class="reference internal" href="#fprintf">fprintf</a>(), <a class="reference internal" href="#fflush">fflush</a>() and <a class="reference internal" href="#fwrite">fwrite</a>() functions.
Example:</p>
<div class="last highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">line</span><span class="p">,</span> <span class="nx">inf</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">stdin</span><span class="p">.</span><span class="nx">readLine</span><span class="p">();</span>

<span class="k">while</span> <span class="p">(</span> <span class="nx">line</span> <span class="o">=</span> <span class="nx">inf</span><span class="p">.</span><span class="nx">next</span><span class="p">()</span> <span class="p">)</span>
   <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">stdout</span><span class="p">.</span><span class="nx">fprintf</span><span class="p">(</span><span class="s2">&quot;%s&quot;</span><span class="p">,</span> <span class="nx">line</span><span class="p">);</span> <span class="c1">//same as rampart.utils.printf</span>
</pre></div>
</div>
</dd>
</dl>
<div class="section" id="fopen">
<h3>fopen<a class="headerlink" href="#fopen" title="Permalink to this headline">¬∂</a></h3>
<p>Open a filehandle for use with <a class="reference internal" href="#fprintf">fprintf</a>(), <a class="reference internal" href="#fclose">fclose</a>(), <a class="reference internal" href="#fseek">fseek</a>(),
<a class="reference internal" href="#rewind">rewind</a>(), <a class="reference internal" href="#ftell">ftell</a>(), <a class="reference internal" href="#fflush">fflush</a>() <a class="reference internal" href="#fread">fread</a>(), <a class="reference internal" href="#fgets">fgets</a>(), <a class="reference internal" href="#fwrite">fwrite</a>() and
<a class="reference internal" href="#readline">readLine</a>().</p>
<dl class="docutils">
<dt>Return Value:</dt>
<dd><span class="green">Object</span>. An object which opaquely contains the opened file handle along with
the above functions.</dd>
</dl>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">handle</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">fopen</span><span class="p">(</span><span class="nx">filename</span><span class="p">,</span> <span class="nx">mode</span><span class="p">[,</span> <span class="nx">stdRedir</span><span class="p">]);</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">filename</span></code> is a <span class="green">String</span> containing the file to be opened.</p>
<p>Where <code class="docutils literal notranslate"><span class="pre">mode</span></code> is a <span class="green">String</span> (one of the following):</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">&quot;r&quot;</span></code> - Open text file for reading.  The stream is positioned at the
beginning of the file.</li>
<li><code class="docutils literal notranslate"><span class="pre">&quot;r+&quot;</span></code> - Open for reading and writing.  The stream is positioned at the
beginning of the file.</li>
<li><code class="docutils literal notranslate"><span class="pre">&quot;w&quot;</span></code> - Truncate file to zero length or create text file for writing.
The stream is positioned at the beginning of the file.</li>
<li><code class="docutils literal notranslate"><span class="pre">&quot;w+&quot;</span></code> - Open for reading and writing.  The file is created if it does
not exist, otherwise it is truncated.  The stream is positioned at the
beginning of the file.</li>
<li><code class="docutils literal notranslate"><span class="pre">&quot;a&quot;</span></code> - Open for appending (writing at end of file).  The file is
created if it does not exist.  The stream is positioned at the end of the
file.</li>
<li><code class="docutils literal notranslate"><span class="pre">&quot;a+&quot;</span></code> - Open for reading and appending (writing at end of file).  The
file is created if it does not exist.  The initial file position for reading
is at the beginning of the file, but output is always appended to the end of the
file.</li>
</ul>
<p>Where optional <code class="docutils literal notranslate"><span class="pre">stdRedir</span></code> is one of <code class="docutils literal notranslate"><span class="pre">rampart.utils.stdin</span></code>, <code class="docutils literal notranslate"><span class="pre">rampart.utils.stdout</span></code>
or <code class="docutils literal notranslate"><span class="pre">rampart.utils.stderr</span></code> and the mode is set appropriately (<code class="docutils literal notranslate"><span class="pre">&quot;r&quot;</span></code> for stdin, <code class="docutils literal notranslate"><span class="pre">&quot;w&quot;</span></code>
or <code class="docutils literal notranslate"><span class="pre">a</span></code> for stdout/stderr; no <code class="docutils literal notranslate"><span class="pre">&quot;+&quot;</span></code> allowed).  Any data read or written to one of the
<code class="docutils literal notranslate"><span class="pre">std</span></code> filehandles will be redirected to the newly opened file.  When the filehandle
is closed, the <code class="docutils literal notranslate"><span class="pre">std</span></code> filehandle will be restored to its previous value.</p>
</div>
<div class="section" id="fopenbuffer">
<h3>fopenBuffer<a class="headerlink" href="#fopenbuffer" title="Permalink to this headline">¬∂</a></h3>
<p>Open a filehandle that writes to a dynamically sized opaque buffer
for use with <a class="reference internal" href="#fprintf">fprintf</a>(), <a class="reference internal" href="#fclose">fclose</a>(), <a class="reference internal" href="#fseek">fseek</a>(),
<a class="reference internal" href="#rewind">rewind</a>(), <a class="reference internal" href="#ftell">ftell</a>(), <a class="reference internal" href="#fflush">fflush</a>() <a class="reference internal" href="#fread">fread</a>(), <a class="reference internal" href="#fgets">fgets</a>(), <a class="reference internal" href="#fwrite">fwrite</a>() and
<a class="reference internal" href="#readline">readLine</a>().</p>
<dl class="docutils">
<dt>Return Value:</dt>
<dd><span class="green">Object</span>. An object which opaquely contains the opened file handle along with
the above functions.</dd>
</dl>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">handle</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">fopenBuffer</span><span class="p">([</span><span class="nx">chunkSize</span><span class="p">][,</span> <span class="nx">sdtRedir</span><span class="p">]);</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">chunkSize</span></code> is a <span class="green">Number</span> (default is <code class="docutils literal notranslate"><span class="pre">4096</span></code>), amount of memory to allocate each
time the buffer is resized.  When the filehandle is closed, the buffer will
be sized to fit the data written, if necessary.</p>
<p>Where optional <code class="docutils literal notranslate"><span class="pre">stdRedir</span></code> is one of <code class="docutils literal notranslate"><span class="pre">rampart.utils.stdout</span></code> or
<code class="docutils literal notranslate"><span class="pre">rampart.utils.stderr</span></code>.  Any data written to one of the <code class="docutils literal notranslate"><span class="pre">std</span></code>
filehandles will be redirected to the newly opened filehandle and placed in
the buffer.  When the filehandle is closed, the <code class="docutils literal notranslate"><span class="pre">std</span></code> filehandle will be
restored to its previous value.</p>
<dl class="docutils">
<dt>Return Value:</dt>
<dd><span class="green">Object</span>. An object which opaquely contains the opened file handle along with
the same functions as in <code class="docutils literal notranslate"><span class="pre">fopen()</span></code> above, as well as <code class="docutils literal notranslate"><span class="pre">destroy()</span></code>, <code class="docutils literal notranslate"><span class="pre">getBuffer()</span></code> and <code class="docutils literal notranslate"><span class="pre">getString()</span></code>
functions, which will delete the backing data or copy the backing data and return the corresponding
JavaScript type.</dd>
<dt>Note:</dt>
<dd>Calling <code class="docutils literal notranslate"><span class="pre">fclose()</span></code> will close the file handle, but the backing buffer is still available for use with
<code class="docutils literal notranslate"><span class="pre">getBuffer()</span></code> and <code class="docutils literal notranslate"><span class="pre">getString()</span></code>.  Calling <code class="docutils literal notranslate"><span class="pre">destroy()</span></code> will close close the file handle if still open
and delete the backing buffer.  There is no finalizer on the returned object, so it is important
to call <code class="docutils literal notranslate"><span class="pre">destroy()</span></code> when it is no longer needed.  Also note that the <code class="docutils literal notranslate"><span class="pre">fopenBuffer()</span></code> return object can be
used in several threads at the same time, so long as it hasn‚Äôt been destroyed in any thread.  Attempting to
use a destroyed <code class="docutils literal notranslate"><span class="pre">fopenBuffer()</span></code> object will throw an error.</dd>
</dl>
<p>Example:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">rampart</span><span class="p">.</span><span class="nx">globalize</span><span class="p">(</span><span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">fh</span> <span class="o">=</span> <span class="nx">fopenBuffer</span><span class="p">(</span><span class="nx">stdout</span><span class="p">);</span>

<span class="c1">// prints to buffer</span>
<span class="nx">printf</span><span class="p">(</span><span class="s2">&quot;line 1\n&quot;</span><span class="p">);</span>
<span class="c1">// also prints to buffer</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;line 2&quot;</span><span class="p">);</span>

<span class="c1">//stdout restored after close</span>
<span class="nx">fclose</span><span class="p">(</span><span class="nx">fh</span><span class="p">);</span> <span class="c1">// or fh.fclose()</span>

<span class="nx">printf</span><span class="p">(</span><span class="s2">&quot;file handle closed\n&quot;</span><span class="p">);</span>
<span class="c1">// this goes to the terminal like expected</span>
<span class="nx">printf</span><span class="p">(</span><span class="s2">&quot;%s&quot;</span><span class="p">,</span> <span class="nx">fh</span><span class="p">.</span><span class="nx">getString</span><span class="p">()</span> <span class="p">);</span>

<span class="c1">// manual cleanup is necessary</span>
<span class="nx">fh</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>

<span class="cm">/* expected output&quot;</span>

<span class="cm">      file handle closed</span>
<span class="cm">      line 1</span>
<span class="cm">      line 2</span>
<span class="cm">*/</span>
</pre></div>
</div>
</div>
<div class="section" id="fclose">
<h3>fclose<a class="headerlink" href="#fclose" title="Permalink to this headline">¬∂</a></h3>
<p>Close a previously opened handle <span class="green">Object</span> opened with <a class="reference internal" href="#fopen">fopen</a>() or
<a class="reference internal" href="#fopenbuffer">fopenBuffer</a>().</p>
<p>Example:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">handle</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">fopen</span><span class="p">(</span><span class="s2">&quot;/tmp/out.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">);</span>

<span class="p">...</span>

<span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">fclose</span><span class="p">(</span><span class="nx">handle</span><span class="p">);</span>

  <span class="cm">/* or */</span>

<span class="nx">handle</span><span class="p">.</span><span class="nx">fclose</span><span class="p">();</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Return Value:</dt>
<dd><code class="docutils literal notranslate"><span class="pre">undefined</span></code>.</dd>
</dl>
</div>
<div class="section" id="fprintf">
<h3>fprintf<a class="headerlink" href="#fprintf" title="Permalink to this headline">¬∂</a></h3>
<p>Same as <a class="reference internal" href="#printf">printf</a>() except output is sent to the file provided by
a <span class="green">String</span> or filehandle <span class="green">Object</span> opened and returned from <a class="reference internal" href="#fopen">fopen</a>().</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">filename</span> <span class="o">=</span> <span class="s2">&quot;/home/user/myfile.txt&quot;</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">output</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">fopen</span><span class="p">(</span><span class="nx">filename</span><span class="p">,</span> <span class="nx">mode</span><span class="p">);</span>
<span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">fprintf</span><span class="p">(</span><span class="nx">output</span><span class="p">,</span> <span class="nx">fmt</span><span class="p">,</span> <span class="p">...);</span>
<span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">fclose</span><span class="p">(</span><span class="nx">output</span><span class="p">);</span>

<span class="cm">/* or */</span>

<span class="kd">var</span> <span class="nx">output</span> <span class="o">=</span> <span class="nx">filename</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">outputLen</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">fprintf</span><span class="p">(</span><span class="nx">output</span><span class="p">,</span> <span class="p">[,</span> <span class="nx">append</span><span class="p">],</span> <span class="nx">fmt</span><span class="p">,</span> <span class="p">...);</span>
<span class="cm">/* file is automatically closed after function returns */</span>
</pre></div>
</div>
<p>Where:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">output</span></code> may be a <span class="green">String</span> (a file name), or an <span class="green">Object</span> returned from <a class="reference internal" href="#fopen">fopen</a>().</li>
<li><code class="docutils literal notranslate"><span class="pre">fmt</span></code> is a <span class="green">String</span>, a <a class="reference internal" href="#printf">printf</a>() format.</li>
<li><code class="docutils literal notranslate"><span class="pre">append</span></code> is an optional <span class="green">Boolean</span> only used when output is a filename- if <code class="docutils literal notranslate"><span class="pre">true</span></code>
the file will be appended instead of overwritten.</li>
</ul>
<dl class="docutils">
<dt>Return Value:</dt>
<dd>A <span class="green">Number</span>. The length in bytes of the printed string.</dd>
</dl>
<p>Example:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">rampart</span><span class="p">.</span><span class="nx">globalize</span><span class="p">(</span><span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">handle</span> <span class="o">=</span> <span class="nx">fopen</span><span class="p">(</span><span class="s2">&quot;/tmp/out.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w+&quot;</span><span class="p">);</span>
<span class="nx">fprintf</span><span class="p">(</span><span class="nx">handle</span><span class="p">,</span> <span class="s2">&quot;A number: %d\n&quot;</span><span class="p">,</span> <span class="mi">123</span><span class="p">);</span>
<span class="nx">fclose</span><span class="p">(</span><span class="nx">handle</span><span class="p">);</span>

<span class="cm">/* OR */</span>

<span class="nx">fprintf</span><span class="p">(</span><span class="s2">&quot;/tmp/out.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;A number: %d\n&quot;</span><span class="p">,</span> <span class="mi">123</span><span class="p">);</span> <span class="cm">/* implicit fclose */</span>
</pre></div>
</div>
</div>
<div class="section" id="fseek">
<h3>fseek<a class="headerlink" href="#fseek" title="Permalink to this headline">¬∂</a></h3>
<p>Set file position for file operations.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">fseek</span><span class="p">(</span><span class="nx">handle</span><span class="p">,</span> <span class="nx">offset</span><span class="p">[,</span> <span class="nx">whence</span><span class="p">]);</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="19%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Argument</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>handle</td>
<td><span class="green">Object</span></td>
<td>A handle opened with <a class="reference internal" href="#fopen">fopen</a>()</td>
</tr>
<tr class="row-odd"><td>offset</td>
<td><span class="green">Number</span></td>
<td>offset in bytes from whence</td>
</tr>
<tr class="row-even"><td rowspan="3">whence</td>
<td rowspan="3"><span class="green">String</span></td>
<td>‚Äúseek_set‚Äù - measure offset from start of file (default)</td>
</tr>
<tr class="row-odd"><td>‚Äúseek_cur‚Äù - measure offset from current position</td>
</tr>
<tr class="row-even"><td>‚Äúseek_end‚Äù - measure offset from end of file.</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Return Value:</dt>
<dd><code class="docutils literal notranslate"><span class="pre">undefined</span></code></dd>
</dl>
<p>Example</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">rampart</span><span class="p">.</span><span class="nx">globalize</span><span class="p">(</span><span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">,</span>
  <span class="p">[</span><span class="s2">&quot;fopen&quot;</span><span class="p">,</span><span class="s2">&quot;printf&quot;</span><span class="p">,</span><span class="s2">&quot;fprintf&quot;</span><span class="p">,</span><span class="s2">&quot;fseek&quot;</span><span class="p">,</span><span class="s2">&quot;fread&quot;</span><span class="p">]);</span>

<span class="kd">var</span> <span class="nx">handle</span> <span class="o">=</span> <span class="nx">fopen</span><span class="p">(</span><span class="s2">&quot;/tmp/out.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w+&quot;</span><span class="p">);</span>

<span class="nx">fprintf</span><span class="p">(</span><span class="nx">handle</span><span class="p">,</span> <span class="s2">&quot;123def&quot;</span><span class="p">);</span>

<span class="nx">fseek</span><span class="p">(</span><span class="nx">handle</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;seek_set&quot;</span><span class="p">);</span>

<span class="nx">fprintf</span><span class="p">(</span><span class="nx">handle</span><span class="p">,</span> <span class="s2">&quot;abc&quot;</span><span class="p">);</span>

<span class="nx">fseek</span><span class="p">(</span><span class="nx">handle</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;seek_set&quot;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">out</span><span class="o">=</span><span class="nx">fread</span><span class="p">(</span><span class="nx">handle</span><span class="p">);</span>

<span class="nx">printf</span><span class="p">(</span><span class="s2">&quot;&#39;%s&#39;\n&quot;</span><span class="p">,</span> <span class="nx">out</span><span class="p">);</span>
<span class="cm">/*</span>
<span class="cm">expect output:</span>
<span class="cm">&#39;abcdef&#39;</span>
<span class="cm">*/</span>

<span class="nx">fclose</span><span class="p">(</span><span class="nx">handle</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="rewind">
<h3>rewind<a class="headerlink" href="#rewind" title="Permalink to this headline">¬∂</a></h3>
<p>Set the file position to the beginning of the file.  It is equivalent to:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">fseek</span><span class="p">(</span><span class="nx">handle</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;seek_set&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">rewind</span><span class="p">(</span><span class="nx">handle</span><span class="p">);</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Return Value:</dt>
<dd><code class="docutils literal notranslate"><span class="pre">undefined</span></code></dd>
</dl>
</div>
<div class="section" id="ftell">
<h3>ftell<a class="headerlink" href="#ftell" title="Permalink to this headline">¬∂</a></h3>
<p>Obtain the current value of the file position for the handle opened with
<a class="reference internal" href="#fopen">fopen</a>().</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">pos</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">ftell</span><span class="p">(</span><span class="nx">handle</span><span class="p">);</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Return Value:</dt>
<dd><span class="green">Number</span>. Current position of <code class="docutils literal notranslate"><span class="pre">handle</span></code>.</dd>
</dl>
</div>
<div class="section" id="fflush">
<h3>fflush<a class="headerlink" href="#fflush" title="Permalink to this headline">¬∂</a></h3>
<p>For output file handles opened with <a class="reference internal" href="#fopen">fopen</a>(), or for
<code class="docutils literal notranslate"><span class="pre">stdout</span></code>/<code class="docutils literal notranslate"><span class="pre">stderr</span></code>/<code class="docutils literal notranslate"><span class="pre">accessLog</span></code>/<code class="docutils literal notranslate"><span class="pre">errorLog</span></code>, <code class="docutils literal notranslate"><span class="pre">fflush()</span></code> forces a
write of buffered data.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">fflush</span><span class="p">(</span><span class="nx">handle</span><span class="p">);</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Return Value:</dt>
<dd><code class="docutils literal notranslate"><span class="pre">undefined</span></code></dd>
</dl>
<p>Example:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="cm">/* normally a flush happens automatically</span>
<span class="cm">   when a &#39;\n&#39; is printed.  Since we are using</span>
<span class="cm">   &#39;\r&#39;, flush manually                        */</span>

<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
   <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">printf</span><span class="p">(</span><span class="s2">&quot;doing #%d\r&quot;</span><span class="p">,</span> <span class="nx">i</span><span class="p">);</span>
   <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">fflush</span><span class="p">(</span><span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">stdout</span><span class="p">);</span>
   <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">printf</span><span class="p">(</span><span class="s2">&quot;blast off!!!\n&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="fread">
<h3>fread<a class="headerlink" href="#fread" title="Permalink to this headline">¬∂</a></h3>
<p>Read data from a file, handle opened with <a class="reference internal" href="#fopen">fopen</a>() or the pre-opened handle <code class="docutils literal notranslate"><span class="pre">stdin</span></code>.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">fread</span><span class="p">([</span><span class="nx">handle</span><span class="o">|</span><span class="nx">file</span><span class="p">]</span> <span class="p">[,</span> <span class="nx">max_size</span> <span class="p">[,</span> <span class="nx">chunk_size</span> <span class="p">[,</span><span class="nx">returnString</span><span class="p">]]]);</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="21%" />
<col width="64%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Argument</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>handle</td>
<td><span class="green">Object</span></td>
<td>A handle opened with <a class="reference internal" href="#fopen">fopen</a>()</td>
</tr>
<tr class="row-odd"><td>file</td>
<td><span class="green">String</span></td>
<td>A filename ‚Äì file will be auto opened and closed</td>
</tr>
<tr class="row-even"><td>max_size</td>
<td><span class="green">Number</span></td>
<td>Maximum number of bytes to read.  Unlimited if
not specified.</td>
</tr>
<tr class="row-odd"><td>chunk_size</td>
<td><span class="green">Number</span></td>
<td>Initial size of return <span class="green">Buffer</span> and number
of bytes to read at a time. If the total number of
bytes read is greater, the buffer grows as needed.
If total bytes read is less, the returned buffer
will be reduced in size to match. Default is 4096
if not specified.</td>
</tr>
<tr class="row-even"><td>returnString</td>
<td><span class="green">Boolean</span></td>
<td>Whether return value is returned as a
<span class="green">String</span>.  Default is <code class="docutils literal notranslate"><span class="pre">false</span></code>.</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Return Value:</dt>
<dd>A <span class="green">Buffer</span> or a <span class="green">String</span> if <code class="docutils literal notranslate"><span class="pre">returnString</span></code> is <code class="docutils literal notranslate"><span class="pre">true</span></code>.</dd>
</dl>
</div>
<div class="section" id="fgets">
<h3>fgets<a class="headerlink" href="#fgets" title="Permalink to this headline">¬∂</a></h3>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">fgets</span><span class="p">([</span><span class="nx">handle</span><span class="o">|</span><span class="nx">file</span><span class="p">]</span> <span class="p">[,</span> <span class="nx">options</span><span class="p">[,</span> <span class="nx">max_size</span><span class="p">]]);</span>
</pre></div>
</div>
<p>Read data from file, up to <code class="docutils literal notranslate"><span class="pre">max_size</span></code> bytes (default <code class="docutils literal notranslate"><span class="pre">1</span></code>), stopping at
and including the first <code class="docutils literal notranslate"><span class="pre">\n</span></code> or the end of the file.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">options</span></code> is included, it must be an <span class="green">Object</span>, where if set to <code class="docutils literal notranslate"><span class="pre">{&quot;echo&quot;:false}</span></code>, and reading from
<code class="docutils literal notranslate"><span class="pre">stdin</span></code>, echoing typed characters on the terminal will be disabled (e.g., for entering
passwords).</p>
<dl class="docutils">
<dt>Return Value:</dt>
<dd>A <span class="green">String</span>.</dd>
</dl>
</div>
<div class="section" id="fwrite">
<h3>fwrite<a class="headerlink" href="#fwrite" title="Permalink to this headline">¬∂</a></h3>
<p>Write data to a file, a handle opened with <a class="reference internal" href="#fopen">fopen</a>() or a pre-opened
output handle (<code class="docutils literal notranslate"><span class="pre">stdout</span></code>/<code class="docutils literal notranslate"><span class="pre">stderr</span></code>/<code class="docutils literal notranslate"><span class="pre">accessLog</span></code>/<code class="docutils literal notranslate"><span class="pre">errorLog</span></code>).  If using
a handle, the start of the write will be the current position based on how
the file was opened and whether any seeks have been performed.  If using a
file name, the <code class="docutils literal notranslate"><span class="pre">append</span></code> parameter will determine whether the file is
appended or truncated.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">nbytes</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">fwrite</span><span class="p">([</span><span class="nx">handle</span><span class="o">|</span><span class="nx">file</span><span class="p">],</span> <span class="nx">data</span> <span class="p">[,</span> <span class="nx">max_bytes</span><span class="p">][,</span> <span class="nx">append</span><span class="p">]);</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="21%" />
<col width="64%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Argument</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>handle</td>
<td><span class="green">Object</span></td>
<td>A handle opened with <a class="reference internal" href="#fopen">fopen</a>()</td>
</tr>
<tr class="row-odd"><td>file</td>
<td><span class="green">String</span></td>
<td>A filename ‚Äì file will be auto opened and closed</td>
</tr>
<tr class="row-even"><td>data</td>
<td><span class="green">Buffer</span>/
<span class="green">String</span></td>
<td>The data to be written.</td>
</tr>
<tr class="row-odd"><td>max_bytes</td>
<td><span class="green">Number</span></td>
<td>Maximum number of bytes to write. <span class="green">Buffer</span>/
<span class="green">String</span> length if not specified.</td>
</tr>
<tr class="row-even"><td>append</td>
<td><span class="green">Boolean</span></td>
<td>If opened with <code class="docutils literal notranslate"><span class="pre">file</span></code> instead of <code class="docutils literal notranslate"><span class="pre">handle</span></code>,
whether to append the file.  Default is <code class="docutils literal notranslate"><span class="pre">false</span></code>,
in which case the file will be truncated.</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Return Value:</dt>
<dd>A <span class="green">Number</span>. Number of bytes written.</dd>
</dl>
</div>
<div class="section" id="readline">
<h3>readLine<a class="headerlink" href="#readline" title="Permalink to this headline">¬∂</a></h3>
<p>Read a text file line-by-line.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">rl</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">readLine</span><span class="p">(</span><span class="nx">file</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">line</span> <span class="o">=</span> <span class="nx">rl</span><span class="p">.</span><span class="nx">next</span><span class="p">();</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">file</span></code> is a <span class="green">String</span> (name of file to be read) or a file handle opened
with with <a class="reference internal" href="#fopen">fopen</a>() or <code class="docutils literal notranslate"><span class="pre">rampart.utils.stdin</span></code>. It returns a <span class="green">Object</span>
that contains the property <code class="docutils literal notranslate"><span class="pre">next</span></code> which is <span class="green">Function</span> to retrieve and return the next
line of text in the opened file.</p>
<dl class="docutils">
<dt>Return Value:</dt>
<dd>An <span class="green">Object</span>.  Property <code class="docutils literal notranslate"><span class="pre">next</span></code> of the return <span class="green">Object</span> is a
<span class="green">Function</span> which retrieves and returns the next line of text in
the file.  After the last line of <code class="docutils literal notranslate"><span class="pre">file</span></code> is returned, subsequent calls
to <code class="docutils literal notranslate"><span class="pre">next</span></code> will return <code class="docutils literal notranslate"><span class="pre">null</span></code>.</dd>
</dl>
<p>Example:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">rl</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">readLine</span><span class="p">(</span><span class="s2">&quot;./myfile.txt&quot;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">line</span><span class="p">,</span> <span class="nx">firstline</span><span class="p">,</span> <span class="nx">lastline</span><span class="p">;</span>

<span class="k">while</span> <span class="p">(</span> <span class="p">(</span><span class="nx">line</span><span class="o">=</span><span class="nx">rl</span><span class="p">.</span><span class="nx">next</span><span class="p">())</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">i</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
        <span class="nx">firstline</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">trim</span><span class="p">(</span><span class="nx">line</span><span class="p">);</span>
    <span class="nx">i</span><span class="o">++</span><span class="p">;</span>
    <span class="nx">lastline</span> <span class="o">=</span> <span class="nx">line</span><span class="p">;</span>
<span class="p">}</span>
<span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">printf</span><span class="p">(</span><span class="s2">&quot;%s\n%s\n&quot;</span><span class="p">,</span> <span class="nx">firstline</span><span class="p">,</span> <span class="nx">lastline</span><span class="p">);</span>

<span class="cm">/* expected output: first and last line of file &quot;./myfile.txt&quot; */</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="rand-hash-and-hyperloglog">
<h2>Rand, Hash and HyperLogLog<a class="headerlink" href="#rand-hash-and-hyperloglog" title="Permalink to this headline">¬∂</a></h2>
<p>Included in rampart.utils are several non-cryptographic functions which have been optimized for speed and ease of use.</p>
<p>Note that the <a class="reference internal" href="#rand">rand</a>() and <a class="reference internal" href="#hash">hash</a>() functions are not of cryptographic quality.  For cryptographic quality hashes
and random numbers, see <a class="reference internal" href="rampart-crypto.html#preface"><span class="std std-ref">The Rampart-Crypto Module</span></a>.</p>
<div class="section" id="rand">
<h3>rand<a class="headerlink" href="#rand" title="Permalink to this headline">¬∂</a></h3>
<p>Generate a random number using a fast, non-cryptographic random number generator.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">rn</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">rand</span><span class="p">([</span><span class="nx">min</span><span class="p">,</span> <span class="nx">max</span><span class="p">]);</span>

   <span class="cm">/* or */</span>

<span class="kd">var</span> <span class="nx">rn</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">rand</span><span class="p">(</span><span class="nx">max</span><span class="p">);</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">min</span></code> is the floor and <code class="docutils literal notranslate"><span class="pre">max</span></code>
is the ceiling (EXCLUSIVE) of the range of the random number to produce.
If not provided, <code class="docutils literal notranslate"><span class="pre">min</span></code> and <code class="docutils literal notranslate"><span class="pre">max</span></code> default to <code class="docutils literal notranslate"><span class="pre">0.0</span></code> and
<code class="docutils literal notranslate"><span class="pre">1.0</span></code> respectively.</p>
<dl class="docutils">
<dt>Return Value:</dt>
<dd>A <span class="green">Number</span> - the generated random number.</dd>
</dl>
<p>Note that if srand has not been called before use, the random number generator
will be automatically seeded.</p>
</div>
<div class="section" id="irand">
<h3>irand<a class="headerlink" href="#irand" title="Permalink to this headline">¬∂</a></h3>
<p>Generate a random integer using a fast, non-cryptographic random number generator.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">rn</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">irand</span><span class="p">([</span><span class="nx">min</span><span class="p">,</span> <span class="nx">max</span><span class="p">]);</span>

   <span class="cm">/* or */</span>

<span class="kd">var</span> <span class="nx">rn</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">irand</span><span class="p">(</span><span class="nx">max</span><span class="p">);</span>

   <span class="cm">/* or */</span>

<span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">irand</span><span class="p">([</span><span class="nx">max</span><span class="p">[</span><span class="nx">min</span><span class="p">,</span><span class="nx">max</span><span class="p">]],</span><span class="nx">callback</span><span class="p">);</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">min</span></code> is the floor and <code class="docutils literal notranslate"><span class="pre">max</span></code>
is the ceiling (INCLUSIVE) of the range of the random integers to produce.
If not provided, <code class="docutils literal notranslate"><span class="pre">min</span></code> and <code class="docutils literal notranslate"><span class="pre">max</span></code> default to <code class="docutils literal notranslate"><span class="pre">0</span></code> and
<code class="docutils literal notranslate"><span class="pre">99</span></code> respectively.</p>
<p>If provided, <code class="docutils literal notranslate"><span class="pre">callback</span></code> is a <span class="green">Function</span> <code class="docutils literal notranslate"><span class="pre">callback(r,i)</span></code> where
<code class="docutils literal notranslate"><span class="pre">r</span></code> is the random integer and <code class="docutils literal notranslate"><span class="pre">i</span></code> is the loop count. The <span class="green">Function</span>
will be called repeatedly until it returns <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p>
<dl class="docutils">
<dt>Return Value:</dt>
<dd>A <span class="green">Number</span> - the generated random integer as a number. If
a function is provided, returns <code class="docutils literal notranslate"><span class="pre">undefined</span></code>.</dd>
</dl>
<p>Note that if <a class="reference internal" href="#srand">srand</a> has not been called before use, the random number generator
will be automatically seeded.</p>
<p>Note also because of JavaScript <span class="green">Number</span> precision, the maximum and
minimum <code class="docutils literal notranslate"><span class="pre">max</span></code> or <code class="docutils literal notranslate"><span class="pre">min</span></code> that may be provided is <code class="docutils literal notranslate"><span class="pre">9007199254740991</span></code> and
<code class="docutils literal notranslate"><span class="pre">-9007199254740991</span></code> respectively.</p>
</div>
<div class="section" id="gaussrand">
<h3>gaussrand<a class="headerlink" href="#gaussrand" title="Permalink to this headline">¬∂</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">gaussrand([sigma])</span></code> function returns a random <span class="green">Number</span> using a
fast, non-cryptographic random number generator and based on
a normal distribution centered at zero (<code class="docutils literal notranslate"><span class="pre">0.0</span></code>), where <code class="docutils literal notranslate"><span class="pre">sigma</span></code> is one
standard deviation.  <code class="docutils literal notranslate"><span class="pre">sigma</span></code> is optional, defaulting to <code class="docutils literal notranslate"><span class="pre">1.0</span></code>.</p>
</div>
<div class="section" id="normrand">
<h3>normrand<a class="headerlink" href="#normrand" title="Permalink to this headline">¬∂</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">normrand([scale])</span></code> function returns a random <span class="green">Number</span> using a
fast, non-cryptographic random number generator and based on
a normal distribution centered at zero (<code class="docutils literal notranslate"><span class="pre">0.0</span></code>) and clamped between <code class="docutils literal notranslate"><span class="pre">-scale</span></code>
and <code class="docutils literal notranslate"><span class="pre">scale</span></code>.</p>
<p>Similar to the <a class="reference internal" href="#gaussrand">gaussrand</a> above.  It is equivelant to:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">nrand</span> <span class="o">=</span> <span class="nx">scale</span> <span class="o">*</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">gaussrand</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span><span class="o">/</span><span class="mf">5.0</span><span class="p">;</span>

<span class="k">if</span><span class="p">(</span><span class="nx">nrand</span><span class="o">&gt;</span><span class="nx">scale</span><span class="p">)</span>
    <span class="nx">nrand</span><span class="o">=</span><span class="nx">scale</span><span class="p">;</span>
<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">nrand</span> <span class="o">&lt;</span> <span class="o">-</span><span class="nx">scale</span><span class="p">)</span>
    <span class="nx">nrand</span> <span class="o">=</span> <span class="o">-</span><span class="nx">scale</span><span class="p">;</span>
</pre></div>
</div>
<p>With a <code class="docutils literal notranslate"><span class="pre">scale</span></code> of <code class="docutils literal notranslate"><span class="pre">1.0</span></code> (the default), the distribution of numbers has a
standard deviation of <code class="docutils literal notranslate"><span class="pre">0.2</span></code>.</p>
</div>
<div class="section" id="srand">
<h3>srand<a class="headerlink" href="#srand" title="Permalink to this headline">¬∂</a></h3>
<p>Seed the random number generator for use with the random functions above.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">srand</span><span class="p">([</span><span class="nx">random_num</span><span class="p">]);</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">random_num</span></code> is an optional number to seed the random number generator.  If not specified, a number will
be derived by reading <code class="docutils literal notranslate"><span class="pre">/dev/urandom</span></code>.</p>
</div>
<div class="section" id="hash">
<h3>hash<a class="headerlink" href="#hash" title="Permalink to this headline">¬∂</a></h3>
<p>Calculate the hash of data.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">myhash</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">hash</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span><span class="nx">options</span><span class="p">);</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">data</span></code> is the data from which the hash is calculated and options is
an <span class="green">Object</span> with the following optional properties:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">type</span></code> - the type of hash to be calculated. A <span class="green">String</span>, one of:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">&quot;murmur&quot;</span></code> - A 64 bit hash using the <cite>murmur</cite> algorithm.</li>
<li><code class="docutils literal notranslate"><span class="pre">&quot;city&quot;</span></code> - A 64 bit hash using the <cite>city</cite> algorithm.</li>
<li><code class="docutils literal notranslate"><span class="pre">&quot;city128&quot;</span></code> - A 128 bit hash using the <cite>city</cite> algorithm.  This is the default if not specified.</li>
<li><code class="docutils literal notranslate"><span class="pre">&quot;both&quot;</span></code> - A 192 bit hash ‚Äì the <code class="docutils literal notranslate"><span class="pre">city128</span></code> hash concatenated with the <code class="docutils literal notranslate"><span class="pre">murmur</span></code> hash.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">function</span></code> - Alias for <code class="docutils literal notranslate"><span class="pre">type</span></code>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">returnBuffer</span></code> - a <span class="green">Boolean</span>, if <code class="docutils literal notranslate"><span class="pre">true</span></code>, the hash will be returned as the binary value of the hash
in a a <span class="green">Buffer</span>.  If <code class="docutils literal notranslate"><span class="pre">false</span></code> (the default), the return value will be a <span class="green">String</span> - a hex encoded representation
of the hash.</p>
</li>
</ul>
<dl class="docutils">
<dt>Return Value:</dt>
<dd>A <span class="green">String</span> or <span class="green">Buffer</span> - the computed hash.</dd>
</dl>
</div>
<div class="section" id="hll">
<h3>hll<a class="headerlink" href="#hll" title="Permalink to this headline">¬∂</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">hll</span></code> function calculates a count of unique items based on Rampart‚Äôs own
<a class="reference external" href="https://en.wikipedia.org/wiki/HyperLogLog">hyperloglog</a> algorithm. It allocates and uses
a 16384 byte buffer to calculate a distinct count of items added.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">myhll</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">hll</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>

   <span class="cm">/* or */</span>

<span class="kd">var</span> <span class="nx">myhll</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">hll</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">hllBufferData</span><span class="p">);</span>

   <span class="cm">/* or */</span>

<span class="kd">var</span> <span class="nx">myhll</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">hll</span><span class="p">(</span><span class="nx">name</span> <span class="p">[,</span> <span class="nx">hllBufferData</span><span class="p">],</span> <span class="nx">merge_hll1</span> <span class="p">[,</span> <span class="nx">merge_hll2</span><span class="p">,</span> <span class="p">...]);</span>
</pre></div>
</div>
<p>Where:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">name</span></code> is an arbitrary <span class="green">String</span>.  It may be called again with the same <code class="docutils literal notranslate"><span class="pre">name</span></code>
in order to retrieve the same <cite>hll</cite> <span class="green">Object</span>.</li>
<li><code class="docutils literal notranslate"><span class="pre">hllBufferData</span></code> is a <span class="green">Buffer</span> - The raw <cite>hll</cite> buffer to initialize the new
<cite>hll</cite> <span class="green">Object</span> with data previously extracted using
<a class="reference internal" href="#hll-getbuffer"><span class="std std-ref">getBuffer</span></a> below.</li>
<li><code class="docutils literal notranslate"><span class="pre">merge_hll1</span></code>, <code class="docutils literal notranslate"><span class="pre">merge_hll2</span></code>, etc. are <cite>hll</cite> <span class="green">Objects</span> created with <code class="docutils literal notranslate"><span class="pre">new</span> <span class="pre">rampart.utils.hll(name)</span></code>
to be merged into the new (blank) return <cite>hll</cite> <span class="green">Object</span> in the same manner as
<a class="reference internal" href="#hll-merge"><span class="std std-ref">merge</span></a> below.</li>
</ul>
<dl class="docutils">
<dt>Return Value:</dt>
<dd>An opaque <cite>hll</cite> <span class="green">Object</span> containing the following functions: <code class="docutils literal notranslate"><span class="pre">add</span></code>, <code class="docutils literal notranslate"><span class="pre">addFile</span></code>, <code class="docutils literal notranslate"><span class="pre">count</span></code>, <code class="docutils literal notranslate"><span class="pre">merge</span></code>,
and <code class="docutils literal notranslate"><span class="pre">getBuffer</span></code>.</dd>
</dl>
<p>Note that an <cite>hll</cite> can be referred to from different threads in the
<a class="reference internal" href="rampart-server.html#the-rampart-server-http-module"><span class="std std-ref">Rampart Server</span></a> or inside <a class="reference internal" href="rampart-thread.html#rampart-thread-functions"><span class="std std-ref">Rampart threads</span></a>. Each
thread may specify the same <cite>hll</cite> by using the same name.  In addition, the below
functions are thread-safe.</p>
</div>
<div class="section" id="hll-add">
<h3>hll.add<a class="headerlink" href="#hll-add" title="Permalink to this headline">¬∂</a></h3>
<p>Add a value or values to the <a class="reference internal" href="#hll">hll</a>.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">myhll</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">hll</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>

<span class="nx">myhll</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">value</span></code> is a <span class="green">String</span>, <span class="green">Buffer</span> or an array of <span class="green">Strings</span> and/or <span class="green">Buffers</span>.</p>
<dl class="docutils">
<dt>Return Value:</dt>
<dd>The <cite>hll</cite> <span class="green">Object</span>.</dd>
</dl>
</div>
<div class="section" id="hll-addfile">
<h3>hll.addFile<a class="headerlink" href="#hll-addfile" title="Permalink to this headline">¬∂</a></h3>
<p>Add values to the <a class="reference internal" href="#hll">hll</a> from a file, with each value on a separate line.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">myhll</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">hll</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>

<span class="nx">myhll</span><span class="p">.</span><span class="nx">addFile</span><span class="p">(</span><span class="nx">file</span> <span class="p">[,</span> <span class="nx">delim</span><span class="p">]</span> <span class="p">);</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Where</dt>
<dd><ul class="first last simple">
<li><code class="docutils literal notranslate"><span class="pre">file</span></code> is a <span class="green">String</span> (name of file to be read) or a file handle opened
with with <a class="reference internal" href="#fopen">fopen</a>() or <code class="docutils literal notranslate"><span class="pre">rampart.utils.stdin</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">delim</span></code> is an optional <span class="green">String</span>, the first character of which is used
as a line separator.  The default value is <code class="docutils literal notranslate"><span class="pre">&quot;\n&quot;</span></code>.</li>
</ul>
</dd>
<dt>Return Value:</dt>
<dd>The <cite>hll</cite> <span class="green">Object</span>.</dd>
</dl>
</div>
<div class="section" id="hll-count">
<h3>hll.count<a class="headerlink" href="#hll-count" title="Permalink to this headline">¬∂</a></h3>
<p>Get a current estimate count of distinct items added to the <a class="reference internal" href="#hll">hll</a>.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">myhll</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">hll</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>

<span class="cm">/* add items */</span>
<span class="p">...</span>

<span class="kd">var</span> <span class="nx">mycount</span> <span class="o">=</span> <span class="nx">myhll</span><span class="p">.</span><span class="nx">count</span><span class="p">();</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Return Value:</dt>
<dd>A <span class="green">Number</span>, the estimated number of distinct items added to the <a class="reference internal" href="#hll">hll</a>.</dd>
</dl>
</div>
<div class="section" id="hll-merge">
<h3>hll.merge<a class="headerlink" href="#hll-merge" title="Permalink to this headline">¬∂</a></h3>
<p>Merge one or more <cite>hll</cite> files into the current <cite>hll</cite> in order to calculate an estimate of the number of distinct
items of the union.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">mergedHll</span> <span class="o">=</span> <span class="nx">myhll</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span><span class="nx">myhll2</span> <span class="p">[,</span> <span class="nx">myhll3</span><span class="p">,</span> <span class="p">...]);</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">myhll2</span></code>, <code class="docutils literal notranslate"><span class="pre">myhll3</span></code>, etc. are <cite>hlls</cite> created with <code class="docutils literal notranslate"><span class="pre">new</span> <span class="pre">rampart.utils.hll</span></code> above.</p>
<dl class="docutils">
<dt>Return Value:</dt>
<dd>The <cite>hll</cite> <span class="green">Object</span> merged and updated with the provided <cite>hlls</cite>.</dd>
</dl>
</div>
<div class="section" id="hll-getbuffer">
<h3>hll.getBuffer<a class="headerlink" href="#hll-getbuffer" title="Permalink to this headline">¬∂</a></h3>
<p>Get the raw <cite>hll</cite> buffer as a JavaScript <span class="green">Buffer</span>, which may be used to save
the <cite>hll</cite> to disk using a command such as <a class="reference internal" href="#fwrite">fwrite</a>() above.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">myhll</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">hll</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>

<span class="cm">/* add items */</span>
<span class="p">...</span>

<span class="kd">var</span> <span class="nx">hllbuf</span> <span class="o">=</span> <span class="nx">myhll</span><span class="p">.</span><span class="nx">getBuffer</span><span class="p">();</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Return Value:</dt>
<dd>A <span class="green">Buffer</span> 16384 bytes in length.</dd>
</dl>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="rampart-thread.html" class="btn btn-neutral float-right" title="Rampart Thread Functions" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="rampart-main.html" class="btn btn-neutral" title="Introduction to Rampart" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2025, Moat Crossing Systems.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> and ‚ù§Ô∏è  using a custom <a href="https://github.com/LinxiFan/Sphinx-theme">theme</a> based on <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.6.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/language_data.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>